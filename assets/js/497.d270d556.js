(window.webpackJsonp=window.webpackJsonp||[]).push([[497],{869:function(t,s,a){"use strict";a.r(s);var n=a(9),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"pytorch-nn-sequential-ä½¿ç”¨æ•™ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pytorch-nn-sequential-ä½¿ç”¨æ•™ç¨‹"}},[t._v("#")]),t._v(" PyTorch "),s("code",[t._v("nn.Sequential")]),t._v(" ä½¿ç”¨æ•™ç¨‹")]),t._v(" "),s("h2",{attrs:{id:"ğŸ¯-å­¦ä¹ ç›®æ ‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å­¦ä¹ ç›®æ ‡"}},[t._v("#")]),t._v(" ğŸ¯ å­¦ä¹ ç›®æ ‡")]),t._v(" "),s("ul",[s("li",[t._v("ç†è§£ "),s("code",[t._v("torch.nn.Sequential")]),t._v(" çš„å®šä¹‰æ–¹å¼ä¸ä½¿ç”¨åœºæ™¯")]),t._v(" "),s("li",[t._v("æŒæ¡å¦‚ä½•å‘ "),s("code",[t._v("Sequential")]),t._v(" æ·»åŠ æ¨¡å—ã€åµŒå¥—ç»“æ„ç­‰æŠ€å·§")]),t._v(" "),s("li",[t._v("æŒæ¡å¦‚ä½•è°ƒè¯• "),s("code",[t._v("Sequential")]),t._v("ï¼Œä¾‹å¦‚æŸ¥çœ‹æ¯ä¸€å±‚çš„è¾“å‡ºã€ç»“æ„ç­‰")]),t._v(" "),s("li",[t._v("ç†Ÿæ‚‰ä½¿ç”¨æ–¹å¼å·®å¼‚ï¼ˆä¼ å‚ vs "),s("code",[t._v("OrderedDict")]),t._v("ï¼‰ä¸è¾“å‡ºç»“æ„")]),t._v(" "),s("li",[t._v("æŒæ¡è°ƒè¯•æŠ€å·§å¦‚ "),s("code",[t._v("print(model)")]),t._v("ã€ä½¿ç”¨ "),s("code",[t._v("forward_hook")]),t._v(" ç­‰")])]),t._v(" "),s("h2",{attrs:{id:"ğŸ”-æ ¸å¿ƒ-api-è¡¨æ ¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-æ ¸å¿ƒ-api-è¡¨æ ¼"}},[t._v("#")]),t._v(" ğŸ” æ ¸å¿ƒ API è¡¨æ ¼")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("åŠŸèƒ½")]),t._v(" "),s("th",[t._v("ç”¨æ³•")]),t._v(" "),s("th",[t._v("ç¤ºä¾‹è¾“å…¥")]),t._v(" "),s("th",[t._v("ç¤ºä¾‹è¾“å‡º")]),t._v(" "),s("th",[t._v("è¯´æ˜")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("å®šä¹‰é¡ºåºç½‘ç»œ")]),t._v(" "),s("td",[s("code",[t._v("nn.Sequential(layer1, layer2, ...)")])]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("é¡ºåºæ¨¡å‹")]),t._v(" "),s("td",[t._v("ç›´æ¥ä¼ å…¥æ¨¡å—")])]),t._v(" "),s("tr",[s("td",[t._v("å‘½åå±‚å®šä¹‰")]),t._v(" "),s("td",[s("code",[t._v("nn.Sequential(OrderedDict([...]))")])]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("å«å±‚åæ¨¡å‹")]),t._v(" "),s("td",[t._v("ä¾¿äºè°ƒè¯•")])]),t._v(" "),s("tr",[s("td",[t._v("æ¨¡å‹æ‰“å°")]),t._v(" "),s("td",[s("code",[t._v("print(model)")])]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("ç½‘ç»œç»“æ„")]),t._v(" "),s("td",[t._v("æ¯ä¸€å±‚éƒ½å¯è§")])]),t._v(" "),s("tr",[s("td",[t._v("è°ƒç”¨")]),t._v(" "),s("td",[s("code",[t._v("model(x)")])]),t._v(" "),s("td",[s("code",[t._v("x=[B, C, H, W]")])]),t._v(" "),s("td",[t._v("è¾“å‡ºå¼ é‡")]),t._v(" "),s("td",[t._v("è‡ªåŠ¨æŒ‰é¡ºåºæ‰§è¡Œ")])]),t._v(" "),s("tr",[s("td",[t._v("æ·»åŠ å±‚ï¼ˆä¸å¯å˜ï¼‰")]),t._v(" "),s("td",[s("code",[t._v('model.add_module("name", layer)')])]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("ä¿®æ”¹åç”Ÿæ•ˆ")])]),t._v(" "),s("tr",[s("td",[t._v("æŸ¥çœ‹æŸå±‚è¾“å‡º")]),t._v(" "),s("td",[s("code",[t._v("register_forward_hook")])]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("è¾“å‡ºä¸­é—´å€¼")]),t._v(" "),s("td",[t._v("å¸¸ç”¨äºè°ƒè¯•")])])])]),t._v(" "),s("h2",{attrs:{id:"ğŸ’¡-å°æŠ€å·§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’¡-å°æŠ€å·§"}},[t._v("#")]),t._v(" ğŸ’¡ å°æŠ€å·§")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æŠ€å·§")]),t._v(" "),s("th",[t._v("ç¤ºä¾‹")]),t._v(" "),s("th",[t._v("è¯´æ˜")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("åµŒå¥— Sequential")]),t._v(" "),s("td",[s("code",[t._v("nn.Sequential(nn.Conv2d(...), nn.Sequential(nn.ReLU(), nn.BatchNorm2d(...)))")])]),t._v(" "),s("td",[t._v("æ¨¡å—ç»“æ„æ¸…æ™°")])]),t._v(" "),s("tr",[s("td",[t._v("ä½¿ç”¨ OrderedDict å‘½åæ¯å±‚")]),t._v(" "),s("td",[s("code",[t._v('nn.Sequential(OrderedDict([("conv1", nn.Conv2d(...)), ("relu1", nn.ReLU())]))')])]),t._v(" "),s("td",[s("code",[t._v('model["conv1"]')]),t._v(" ä¸è¡Œï¼Œä½†æ‰“å°å±‚åæ›´æ¸…æ™°")])]),t._v(" "),s("tr",[s("td",[t._v("è¾“å‡ºä¸­é—´ç»“æœ")]),t._v(" "),s("td",[s("code",[t._v("hook = layer.register_forward_hook(hook_fn)")])]),t._v(" "),s("td",[t._v("ç”¨äºè°ƒè¯•ä¸­é—´å±‚è¾“å‡º")])]),t._v(" "),s("tr",[s("td",[t._v("æ‰“å°æ¯å±‚è¾“å‡ºå½¢çŠ¶")]),t._v(" "),s("td",[t._v("åœ¨ "),s("code",[t._v("hook_fn")]),t._v(" ä¸­ "),s("code",[t._v("print(output.shape)")])]),t._v(" "),s("td",[t._v("è¾…åŠ©è°ƒè¯•")])])])]),t._v(" "),s("h2",{attrs:{id:"ğŸ§ª-leetcode-é£æ ¼ç»ƒä¹ é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-leetcode-é£æ ¼ç»ƒä¹ é¢˜"}},[t._v("#")]),t._v(" ğŸ§ª LeetCode é£æ ¼ç»ƒä¹ é¢˜")]),t._v(" "),s("h3",{attrs:{id:"â“é¢˜ç›®-æ‰“å°-sequential-æ¯ä¸€å±‚çš„è¾“å‡ºç»´åº¦"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#â“é¢˜ç›®-æ‰“å°-sequential-æ¯ä¸€å±‚çš„è¾“å‡ºç»´åº¦"}},[t._v("#")]),t._v(" â“é¢˜ç›®ï¼šæ‰“å° "),s("code",[t._v("Sequential")]),t._v(" æ¯ä¸€å±‚çš„è¾“å‡ºç»´åº¦")]),t._v(" "),s("h4",{attrs:{id:"è¾“å…¥ç¤ºä¾‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è¾“å…¥ç¤ºä¾‹"}},[t._v("#")]),t._v(" è¾“å…¥ç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Sequential æ¨¡å‹ï¼š\nnn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReLU"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nè¾“å…¥å¼ é‡ï¼š\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("h4",{attrs:{id:"è¾“å‡ºç¤ºä¾‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è¾“å‡ºç¤ºä¾‹"}},[t._v("#")]),t._v(" è¾“å‡ºç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-text line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("After layer 0 (Linear): torch.Size([5, 8])\nAfter layer 1 (ReLU): torch.Size([5, 8])\nAfter layer 2 (Linear): torch.Size([5, 2])\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"ğŸ§©-å‡½æ•°å®šä¹‰-ä½ éœ€è¦å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§©-å‡½æ•°å®šä¹‰-ä½ éœ€è¦å®ç°"}},[t._v("#")]),t._v(" ğŸ§© å‡½æ•°å®šä¹‰ï¼ˆä½ éœ€è¦å®ç°ï¼‰")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("print_sequential_shapes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"âœ…-å¯ç”¨çš„æ–­è¨€æµ‹è¯•-assert"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-å¯ç”¨çš„æ–­è¨€æµ‹è¯•-assert"}},[t._v("#")]),t._v(" âœ… å¯ç”¨çš„æ–­è¨€æµ‹è¯•ï¼ˆAssertï¼‰")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReLU"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nprint_sequential_shapes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h2",{attrs:{id:"âœ…-è§£æ³•-æ‰“å°ä¸­é—´å±‚è¾“å‡ºç»´åº¦"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-è§£æ³•-æ‰“å°ä¸­é—´å±‚è¾“å‡ºç»´åº¦"}},[t._v("#")]),t._v(" âœ… è§£æ³•ï¼ˆæ‰“å°ä¸­é—´å±‚è¾“å‡ºç»´åº¦ï¼‰")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("print_sequential_shapes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" layer "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("enumerate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" layer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"After layer ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" (")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("layer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__class__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("): ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h2",{attrs:{id:"âœ…-é«˜é˜¶æŠ€å·§-ç”¨-hook-æ‰“å°ä¸­é—´å±‚è¾“å‡º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-é«˜é˜¶æŠ€å·§-ç”¨-hook-æ‰“å°ä¸­é—´å±‚è¾“å‡º"}},[t._v("#")]),t._v(" âœ… é«˜é˜¶æŠ€å·§ï¼šç”¨ Hook æ‰“å°ä¸­é—´å±‚è¾“å‡º")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("register_hooks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" layer "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("enumerate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hook_fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("input")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" output"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"[Hook] ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__class__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(": ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("output"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        layer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register_forward_hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hook_fn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("è°ƒç”¨æ–¹å¼ï¼š")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReLU"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nregister_hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n_ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h2",{attrs:{id:"ğŸ§ -æ€»ç»“-é«˜æ•ˆä½¿ç”¨-sequential"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -æ€»ç»“-é«˜æ•ˆä½¿ç”¨-sequential"}},[t._v("#")]),t._v(" ğŸ§  æ€»ç»“ï¼ˆé«˜æ•ˆä½¿ç”¨ Sequentialï¼‰")]),t._v(" "),s("ul",[s("li",[t._v("âœ… ç”¨ "),s("code",[t._v("OrderedDict")]),t._v(" ç»™æ¯ä¸€å±‚å‘½åï¼Œæ‰“å°æ›´æ¸…æ™°")]),t._v(" "),s("li",[t._v("âœ… æƒ³æŸ¥çœ‹ä¸­é—´å±‚è¾“å‡ºï¼Ÿç”¨ "),s("code",[t._v("forward_hook")]),t._v(" æˆ–æ‰‹åŠ¨ forward")]),t._v(" "),s("li",[t._v("âœ… ä¸èƒ½ç”¨ "),s("code",[t._v('model["conv1"]')]),t._v("ï¼Œè¦ç”¨ "),s("code",[t._v("model[0]")]),t._v(" ä¸‹æ ‡")]),t._v(" "),s("li",[t._v("âœ… ä¸èƒ½ç›´æ¥ "),s("code",[t._v("add_module")]),t._v(" æ”¹å˜å·²æœ‰ç»“æ„ï¼Œè¦é‡æ–°æ„é€  Sequential")])]),t._v(" "),s("h2",{attrs:{id:"ğŸŒ€-è¿›é˜¶æŠ€å·§-æ³¨å†Œ-backward-hook-æŸ¥çœ‹åå‘ä¼ æ’­æ¢¯åº¦"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸŒ€-è¿›é˜¶æŠ€å·§-æ³¨å†Œ-backward-hook-æŸ¥çœ‹åå‘ä¼ æ’­æ¢¯åº¦"}},[t._v("#")]),t._v(" ğŸŒ€ è¿›é˜¶æŠ€å·§ï¼šæ³¨å†Œ Backward Hook æŸ¥çœ‹åå‘ä¼ æ’­æ¢¯åº¦")]),t._v(" "),s("h3",{attrs:{id:"ä½¿ç”¨-register-full-backward-hook-æ¨è"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-register-full-backward-hook-æ¨è"}},[t._v("#")]),t._v(" ä½¿ç”¨ "),s("code",[t._v("register_full_backward_hook")]),t._v("ï¼ˆæ¨èï¼‰")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("register_backward_hooks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" layer "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("enumerate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hook_fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" grad_input"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" grad_output"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"[Backward Hook] ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__class__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(": grad_output = ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("grad_output"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        layer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register_full_backward_hook"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hook_fn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h3",{attrs:{id:"ç¤ºä¾‹è°ƒç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¤ºä¾‹è°ƒç”¨"}},[t._v("#")]),t._v(" ç¤ºä¾‹è°ƒç”¨")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReLU"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nregister_backward_hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" requires_grad"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\noutput "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nloss "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" output"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nloss"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("blockquote",[s("p",[t._v("ğŸ” "),s("code",[t._v("register_full_backward_hook")]),t._v(" æ˜¯ä» PyTorch 1.8 èµ·æ¨èä½¿ç”¨çš„æ–¹å¼ï¼Œé¿å…æ—§ç‰ˆ "),s("code",[t._v("register_backward_hook")]),t._v(" ä¸­å¯èƒ½ä¸¢å¤± grad çš„é—®é¢˜ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"æç¤º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æç¤º"}},[t._v("#")]),t._v(" æç¤º")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("grad_input")]),t._v(": æ˜¯å½“å‰å±‚è¾“å…¥çš„æ¢¯åº¦ï¼ˆtuple of tensorsï¼‰")]),t._v(" "),s("li",[s("code",[t._v("grad_output")]),t._v(": æ˜¯å½“å‰å±‚è¾“å‡ºçš„æ¢¯åº¦ï¼ˆtuple of tensorsï¼‰")]),t._v(" "),s("li",[t._v("ä¸ºäº†é¿å…é—­åŒ…é—®é¢˜ï¼Œæ¨èä½¿ç”¨ "),s("code",[t._v("functools.partial")]),t._v(" æˆ–åœ¨ hook ä¸­ç»‘å®šå±€éƒ¨å˜é‡")])])])}),[],!1,null,null,null);s.default=e.exports}}]);