(window.webpackJsonp=window.webpackJsonp||[]).push([[476],{848:function(t,s,a){"use strict";a.r(s);var n=a(9),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ç¬¬ä¸€ç« -å¼ºåŒ–å­¦ä¹ é—®é¢˜-sutton-barto-ä¸­æ–‡ç‰ˆæ•´ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬ä¸€ç« -å¼ºåŒ–å­¦ä¹ é—®é¢˜-sutton-barto-ä¸­æ–‡ç‰ˆæ•´ç†"}},[t._v("#")]),t._v(" ç¬¬ä¸€ç« ï¼šå¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼ˆSutton & Barto ä¸­æ–‡ç‰ˆæ•´ç†ï¼‰")]),t._v(" "),s("h2",{attrs:{id:"ğŸ¯-å­¦ä¹ ç›®æ ‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å­¦ä¹ ç›®æ ‡"}},[t._v("#")]),t._v(" ğŸ¯ å­¦ä¹ ç›®æ ‡")]),t._v(" "),s("ul",[s("li",[t._v("ç†è§£å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learning, RLï¼‰çš„æ ¸å¿ƒç‰¹å¾")]),t._v(" "),s("li",[t._v("æŒæ¡ RL ä¸ç›‘ç£å­¦ä¹ ã€æ— ç›‘ç£å­¦ä¹ çš„åŒºåˆ«")]),t._v(" "),s("li",[t._v("ç†Ÿæ‚‰ RL çš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼ˆagentã€ç¯å¢ƒã€ç­–ç•¥ã€ä»·å€¼å‡½æ•°ã€å¥–åŠ±ä¿¡å·ã€æ¨¡å‹ï¼‰")]),t._v(" "),s("li",[t._v("é€šè¿‡äº•å­—æ£‹ï¼ˆTic-Tac-Toeï¼‰ç¤ºä¾‹ç†è§£ RL ä¸­æ¢ç´¢-åˆ©ç”¨ã€å€¼å‡½æ•°ã€å­¦ä¹ æ›´æ–°ç­‰æ ¸å¿ƒæ¦‚å¿µ")]),t._v(" "),s("li",[t._v("æ¦‚è§ˆå¼ºåŒ–å­¦ä¹ çš„å†å²ä¸å‘å±•è„‰ç»œ")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ“˜-1-å¼ºåŒ–å­¦ä¹ é—®é¢˜ç®€ä»‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“˜-1-å¼ºåŒ–å­¦ä¹ é—®é¢˜ç®€ä»‹"}},[t._v("#")]),t._v(" ğŸ“˜ 1. å¼ºåŒ–å­¦ä¹ é—®é¢˜ç®€ä»‹")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬ä»ä¸€ä¸ªæœ´ç´ çš„è§‚å¯Ÿå¼€å§‹ï¼šäººç±»å¦‚ä½•å­¦ä¹ ï¼Ÿå©´å„¿é€šè¿‡ä¸ç¯å¢ƒäº’åŠ¨ã€æŒ¥åŠ¨æ‰‹è‡‚ã€è§‚å¯Ÿååº”ï¼Œè‡ªä¸»å­¦ä¹ å› æœå…³ç³»ã€ç›®æ ‡è¾¾æˆæ–¹æ³•ç­‰ã€‚è¿™ç§â€œäº¤äº’å¼å­¦ä¹ â€æ˜¯æˆ‘ä»¬ç†è§£ä¸–ç•Œçš„ä¸»è¦æ–¹å¼ã€‚")]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ æ­£æ˜¯å¯¹è¿™ç§å­¦ä¹ æ–¹å¼çš„è®¡ç®—æ¨¡æ‹Ÿã€‚æˆ‘ä»¬ä» AI å·¥ç¨‹å¸ˆçš„è§’åº¦æ¥ç ”ç©¶â€”â€”"),s("strong",[t._v("å¦‚ä½•è®©æœºå™¨é€šè¿‡ä¸ç¯å¢ƒçš„äº’åŠ¨ï¼Œå­¦ä¹ è¾¾æˆç›®æ ‡çš„èƒ½åŠ›")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ æ–¹æ³•æ¶‰åŠï¼š")]),t._v(" "),s("ul",[s("li",[t._v("ç†è®ºå»ºæ¨¡ï¼ˆå¦‚é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼‰")]),t._v(" "),s("li",[t._v("å­¦ä¹ ç­–ç•¥ï¼ˆå¦‚ä½•è¡ŒåŠ¨ï¼‰")]),t._v(" "),s("li",[t._v("è¯„ä¼°æ–¹æ³•ï¼ˆæ•°å­¦åˆ†ææˆ–å®éªŒï¼‰")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ§©-1-1-ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹ "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§©-1-1-ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹ "}},[t._v("#")]),t._v(" ğŸ§© 1.1 ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹ ï¼Ÿ")]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼‰å…¼å…·ä¸‰é‡èº«ä»½ï¼š")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("ä¸€ç§é—®é¢˜ç±»å‹")]),t._v("ï¼šå­¦ä¹ å¦‚ä½•è¡ŒåŠ¨ä»¥æœ€å¤§åŒ–å¥–åŠ±")]),t._v(" "),s("li",[s("strong",[t._v("ä¸€ç±»æ–¹æ³•é›†åˆ")]),t._v("ï¼šè§£å†³è¿™ç±»é—®é¢˜çš„ç®—æ³•ï¼ˆå¦‚ Q-learningã€PPOï¼‰")]),t._v(" "),s("li",[s("strong",[t._v("ä¸€ä¸ªç ”ç©¶é¢†åŸŸ")]),t._v("ï¼šç ”ç©¶è¿™ä¸€é—®é¢˜ä¸æ–¹æ³•çš„å­¦ç§‘")])]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ çš„ä¸‰å¤§ç‰¹å¾ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("ç‰¹å¾")]),t._v(" "),s("th",[t._v("è§£é‡Š")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("é—­ç¯ç³»ç»Ÿï¼ˆClosed-loopï¼‰")]),t._v(" "),s("td",[t._v("è¡ŒåŠ¨å½±å“ç¯å¢ƒï¼Œç¯å¢ƒåé¦ˆå½±å“æœªæ¥æ„ŸçŸ¥")])]),t._v(" "),s("tr",[s("td",[t._v("æ— æŒ‡å¯¼åé¦ˆï¼ˆNo direct instructionï¼‰")]),t._v(" "),s("td",[t._v("æ— â€œæ­£ç¡®ç­”æ¡ˆâ€ï¼Œagent éœ€é€šè¿‡å°è¯•è·å¾—å¥–åŠ±æœ€å¤§åŒ–ç­–ç•¥")])]),t._v(" "),s("tr",[s("td",[t._v("å»¶è¿Ÿåé¦ˆï¼ˆDelayed consequencesï¼‰")]),t._v(" "),s("td",[t._v("å¥–åŠ±å¯èƒ½å»¶è¿Ÿå¤šæ­¥æ‰æ˜¾ç°ï¼Œè¡Œä¸ºå½±å“è¿œæœŸç»“æœ")])])])]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ æ˜¯"),s("strong",[t._v("ç¬¬ä¸‰ç§å­¦ä¹ èŒƒå¼")]),t._v("ï¼ŒåŒºåˆ«äºï¼š")]),t._v(" "),s("ul",[s("li",[t._v("ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰")]),t._v(" "),s("li",[t._v("æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰")])]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ çš„å…³é”®é—®é¢˜ï¼š"),s("strong",[t._v("æ¢ç´¢ï¼ˆexplorationï¼‰ä¸åˆ©ç”¨ï¼ˆexploitationï¼‰æƒè¡¡")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ¤–-1-2-ç¤ºä¾‹ä¸åŠ¨æœº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¤–-1-2-ç¤ºä¾‹ä¸åŠ¨æœº"}},[t._v("#")]),t._v(" ğŸ¤– 1.2 ç¤ºä¾‹ä¸åŠ¨æœº")]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ åº”ç”¨å¹¿æ³›ï¼Œä»¥ä¸‹æ˜¯ç»å…¸ç¤ºä¾‹ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("â™Ÿï¸ å›½é™…è±¡æ£‹å¤§å¸ˆçš„è½å­å†³ç­–ï¼ˆèåˆç›´è§‰å’Œè§„åˆ’ï¼‰")]),t._v(" "),s("li",[t._v("ğŸ­ å·¥ä¸šæ§åˆ¶å™¨åœ¨çº¿è°ƒèŠ‚çŸ³åŒ–å·¥å‚è¿è¡Œç­–ç•¥")]),t._v(" "),s("li",[t._v("ğŸ¦Œ å°é¹¿å‡ºç”Ÿæ•°åˆ†é’Ÿåå¥”è·‘ï¼Œè¡Œä¸ºå­¦ä¹ è¿…é€Ÿ")]),t._v(" "),s("li",[t._v("ğŸ¤– æœºå™¨äººåœ¨åƒåœ¾å›æ”¶ä¸è¿”å›å……ç”µç«™ä¹‹é—´å†³ç­–")]),t._v(" "),s("li",[t._v("ğŸ§â€â™‚ï¸ Phil åšæ—©é¤æ¶‰åŠå¤šé‡å­ç›®æ ‡ï¼ˆå¦‚æ‹¿ç¢—ã€å€’ç‰›å¥¶ï¼‰")])]),t._v(" "),s("p",[t._v("è¿™äº›ä¾‹å­éƒ½ä½“ç°äº†å¼ºåŒ–å­¦ä¹ çš„æ ¸å¿ƒç‰¹å¾ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ˜ç¡®ç›®æ ‡ï¼ˆç›®æ ‡å¯¼å‘ï¼‰")]),t._v(" "),s("li",[t._v("è¡ŒåŠ¨-ç¯å¢ƒäº¤äº’ï¼ˆagent å¯ä»¥å½±å“ç¯å¢ƒï¼‰")]),t._v(" "),s("li",[t._v("å¥–åŠ±å»¶è¿Ÿä¸è§„åˆ’éœ€æ±‚")]),t._v(" "),s("li",[t._v("ç¯å¢ƒä¸å¯é¢„æµ‹ï¼Œéœ€è¦ agent å…·å¤‡é€‚åº”èƒ½åŠ›")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ§±-1-3-å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬ç»„æˆè¦ç´ "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§±-1-3-å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬ç»„æˆè¦ç´ "}},[t._v("#")]),t._v(" ğŸ§± 1.3 å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬ç»„æˆè¦ç´ ")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("è¦ç´ ")]),t._v(" "),s("th",[t._v("è¯´æ˜")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ç­–ç•¥ï¼ˆPolicyï¼‰")]),t._v(" "),s("td",[t._v("agent åœ¨ç»™å®šçŠ¶æ€ä¸‹çš„è¡Œä¸ºè§„åˆ™ï¼ˆå¯ä»¥æ˜¯å‡½æ•°ã€æŸ¥æ‰¾è¡¨ã€æœç´¢æœºåˆ¶ç­‰ï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("å¥–åŠ±ï¼ˆRewardï¼‰")]),t._v(" "),s("td",[t._v("è¡¨å¾å³æ—¶å¥½åçš„æ•°å€¼ä¿¡å·ï¼ˆç”Ÿç†ç±»æ¯”ï¼šæ„‰æ‚¦ vs. ç—›è‹¦ï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("ä»·å€¼å‡½æ•°ï¼ˆValue Functionï¼‰")]),t._v(" "),s("td",[t._v("è¡¡é‡é•¿æœŸå¥½åï¼šä»å½“å‰çŠ¶æ€å‡ºå‘çš„æœŸæœ›å¥–åŠ±æ€»å’Œ")])]),t._v(" "),s("tr",[s("td",[t._v("ç¯å¢ƒæ¨¡å‹ï¼ˆModelï¼‰")]),t._v(" "),s("td",[t._v("é¢„æµ‹æœªæ¥çŠ¶æ€ä¸å¥–åŠ±çš„æœºåˆ¶ï¼Œç”¨äºè§„åˆ’ï¼ˆå¯é€‰ï¼‰")])])])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("å¥–åŠ±")]),t._v(" æ˜¯â€œç›®æ ‡â€ï¼›"),s("strong",[t._v("ä»·å€¼å‡½æ•°")]),t._v("æ˜¯â€œæ‰‹æ®µâ€ï¼›"),s("strong",[t._v("ç­–ç•¥")]),t._v("æ˜¯â€œé€‰æ‹©çš„å…·ä½“è¡Œä¸ºâ€ï¼›"),s("strong",[t._v("æ¨¡å‹")]),t._v("ç”¨äºæ¨¡æ‹Ÿæœªæ¥ã€‚")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ²-1-4-èŒƒå›´ä¸é™åˆ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ²-1-4-èŒƒå›´ä¸é™åˆ¶"}},[t._v("#")]),t._v(" ğŸ² 1.4 èŒƒå›´ä¸é™åˆ¶")]),t._v(" "),s("ul",[s("li",[t._v("æœ¬ä¹¦å¼ºè°ƒ"),s("strong",[t._v("åŸºäºå€¼å‡½æ•°çš„ RL æ–¹æ³•")])]),t._v(" "),s("li",[t._v("ä¸è¿›åŒ–æ–¹æ³•ï¼ˆå¦‚é—ä¼ ç®—æ³•ï¼‰å¯¹æ¯”ï¼šåè€…å¯¹æ¯ä¸ªå®Œæ•´ç­–ç•¥è¯„ä¼°ï¼Œä¸å…³æ³¨ä¸­é—´è¿‡ç¨‹")]),t._v(" "),s("li",[t._v("è¿›åŒ–æ–¹æ³•å¯èƒ½æ•ˆç‡ä½ï¼Œå¿½ç•¥äº†çŠ¶æ€-åŠ¨ä½œç»“æ„")]),t._v(" "),s("li",[t._v("æˆ‘ä»¬å…³æ³¨çš„æ˜¯ï¼š"),s("strong",[t._v("åœ¨äº¤äº’ä¸­é€æ­¥å­¦ä¹ ç­–ç•¥")]),t._v("ï¼ˆå¯ç»“åˆç›‘ç£ã€æ¨¡å‹ï¼‰")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ®-1-5-äº•å­—æ£‹å¼ºåŒ–å­¦ä¹ ç¤ºä¾‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ®-1-5-äº•å­—æ£‹å¼ºåŒ–å­¦ä¹ ç¤ºä¾‹"}},[t._v("#")]),t._v(" ğŸ® 1.5 äº•å­—æ£‹å¼ºåŒ–å­¦ä¹ ç¤ºä¾‹")]),t._v(" "),s("p",[t._v("é€šè¿‡äº•å­—æ£‹æ¸¸æˆå±•ç¤ºå¼ºåŒ–å­¦ä¹ çš„æ ¸å¿ƒæµç¨‹ï¼š")]),t._v(" "),s("h3",{attrs:{id:"ğŸŒŸ-è®¾å®š"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸŒŸ-è®¾å®š"}},[t._v("#")]),t._v(" ğŸŒŸ è®¾å®šï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æˆ‘ä»¬æ˜¯ X æ–¹ï¼Œå¯¹æ‰‹æ˜¯ä¸å®Œç¾ç©å®¶")]),t._v(" "),s("li",[t._v("çŠ¶æ€ç©ºé—´ï¼šæ‰€æœ‰å¯èƒ½æ£‹å±€")]),t._v(" "),s("li",[t._v("åˆå§‹ä¼°å€¼è¡¨ï¼šèƒœåˆ©çŠ¶æ€=1ï¼Œå¤±è´¥/å¹³å±€=0ï¼Œå…¶ä»–=0.5ï¼ˆåˆå§‹åŒ–ï¼‰")])]),t._v(" "),s("h3",{attrs:{id:"ğŸ¯-ç­–ç•¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ç­–ç•¥"}},[t._v("#")]),t._v(" ğŸ¯ ç­–ç•¥ï¼š")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("è´ªå©ªç­–ç•¥ï¼ˆGreedyï¼‰")]),t._v("ï¼šé€‰æ‹©ä¼°å€¼æœ€é«˜çš„ä¸‹ä¸€æ­¥")]),t._v(" "),s("li",[s("strong",[t._v("æ¢ç´¢åŠ¨ä½œï¼ˆExploratoryï¼‰")]),t._v("ï¼šå¶å°”éšæœºé€‰æ‹©åŠ¨ä½œï¼Œè®¿é—®æœªçŸ¥çŠ¶æ€")])]),t._v(" "),s("h3",{attrs:{id:"ğŸ“‰-æ›´æ–°è§„åˆ™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“‰-æ›´æ–°è§„åˆ™"}},[t._v("#")]),t._v(" ğŸ“‰ æ›´æ–°è§„åˆ™ï¼š")]),t._v(" "),s("p",[t._v("åªåœ¨è´ªå©ªåŠ¨ä½œä¸Šå­¦ä¹ ï¼Œç”¨æ—¶é—´å·®åˆ†æ–¹æ³•æ›´æ–°çŠ¶æ€å€¼ï¼š")]),t._v(" "),s("div",{staticClass:"language-math line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("V(s) â† V(s) + Î± [V(s') - V(s)]\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("å…¶ä¸­ Î± æ˜¯å­¦ä¹ ç‡ï¼ˆstep-size parameterï¼‰")]),t._v(" "),s("blockquote",[s("p",[t._v("å¦‚å›¾æ‰€ç¤ºï¼šé™¤å»æ¢ç´¢åŠ¨ä½œï¼Œæ¯ä¸€æ­¥éƒ½è¿›è¡Œâ€œå€¼å›ä¼ â€ï¼ˆbackupï¼‰ï¼Œæ›´æ–°å½“å‰çŠ¶æ€çš„ä¼°å€¼")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/emmableu/image/master/202507011127968.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"ğŸ§ -å­¦ä¹ ç»“æœ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -å­¦ä¹ ç»“æœ"}},[t._v("#")]),t._v(" ğŸ§  å­¦ä¹ ç»“æœï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœ Î± åˆç†è¡°å‡ï¼Œæœ€ç»ˆèƒ½å­¦åˆ°"),s("strong",[t._v("æœ€ä¼˜ç­–ç•¥")])]),t._v(" "),s("li",[t._v("å­¦åˆ°çš„ç­–ç•¥å¯¹ç¼“æ…¢å˜åŒ–çš„å¯¹æ‰‹ä¹Ÿå…·é²æ£’æ€§")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ”-å¼ºåŒ–å­¦ä¹ -vs-è¿›åŒ–æ–¹æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-å¼ºåŒ–å­¦ä¹ -vs-è¿›åŒ–æ–¹æ³•"}},[t._v("#")]),t._v(" ğŸ” å¼ºåŒ–å­¦ä¹  vs. è¿›åŒ–æ–¹æ³•")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æ–¹æ³•")]),t._v(" "),s("th",[t._v("ç‰¹ç‚¹")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("è¿›åŒ–æ–¹æ³•ï¼ˆEAï¼‰")]),t._v(" "),s("td",[t._v("æ•´ä½“è¯„ä¼°ç­–ç•¥ï¼Œä¸å…³æ³¨ä¸­é—´çŠ¶æ€ï¼Œæ ·æœ¬æ•ˆç‡ä½")])]),t._v(" "),s("tr",[s("td",[t._v("å€¼å‡½æ•°æ–¹æ³•ï¼ˆRLï¼‰")]),t._v(" "),s("td",[t._v("åˆ©ç”¨æ¯æ­¥çŠ¶æ€ä¿¡æ¯ã€å¯è¾¹ç©è¾¹å­¦ã€èƒ½é’ˆå¯¹å…³é”®çŠ¶æ€åšæ›´æ–°")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ§¬-1-6-æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§¬-1-6-æ€»ç»“"}},[t._v("#")]),t._v(" ğŸ§¬ 1.6 æ€»ç»“")]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ æ˜¯ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("ç›®æ ‡å¯¼å‘å­¦ä¹ ä¸å†³ç­–çš„è®¡ç®—æ–¹æ³•")]),t._v(" "),s("li",[t._v("åŸºäºçŠ¶æ€-åŠ¨ä½œ-å¥–åŠ±çš„å½¢å¼å»ºæ¨¡")]),t._v(" "),s("li",[t._v("ä¸ç›‘ç£/æ— ç›‘ç£å­¦ä¹ å¹¶åˆ—çš„ç‹¬ç«‹å­¦ä¹ èŒƒå¼")]),t._v(" "),s("li",[t._v("é‡è§† "),s("strong",[t._v("å€¼å‡½æ•°ä¼°è®¡")]),t._v("ï¼Œä»¥æ›´é«˜æ•ˆæœç´¢æœ€ä¼˜ç­–ç•¥")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ“œ-1-7-å¼ºåŒ–å­¦ä¹ çš„å†å²-ç®€è¦"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“œ-1-7-å¼ºåŒ–å­¦ä¹ çš„å†å²-ç®€è¦"}},[t._v("#")]),t._v(" ğŸ“œ 1.7 å¼ºåŒ–å­¦ä¹ çš„å†å²ï¼ˆç®€è¦ï¼‰")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("åˆ†æ”¯")]),t._v(" "),s("th",[t._v("å†…å®¹")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("è¯•é”™å­¦ä¹ ï¼ˆTrial-and-errorï¼‰")]),t._v(" "),s("td",[t._v("æ¥æºäºå¿ƒç†å­¦å®éªŒï¼ˆThorndikeã€Skinnerï¼‰ï¼Œå¼ºè°ƒå¼ºåŒ–ä¸è¡Œä¸ºé€‰æ‹©")])]),t._v(" "),s("tr",[s("td",[t._v("æœ€ä¼˜æ§åˆ¶ï¼ˆOptimal Controlï¼‰")]),t._v(" "),s("td",[t._v("Bellman æå‡ºåŠ¨æ€è§„åˆ’ï¼Œå»ºç«‹ MDP å½¢å¼åŒ–å»ºæ¨¡")])]),t._v(" "),s("tr",[s("td",[t._v("æ—¶é—´å·®åˆ†å­¦ä¹ ï¼ˆTDï¼‰")]),t._v(" "),s("td",[t._v("Samuelï¼ˆ1959ï¼‰checkersï¼ŒSutton&Barto æå‡º TD(Î»)ã€Actor-Critic æ¶æ„ç­‰")])])])]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ èåˆäº†ä¸Šè¿°ä¸‰æ¡è·¯å¾„ï¼Œå½¢æˆç°ä»£å¼ºåŒ–å­¦ä¹ ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("åŠ¨æ€è§„åˆ’ + TD å­¦ä¹  + å€¼å‡½æ•°è¿‘ä¼¼ + æ·±åº¦å­¦ä¹  â†’ å¦‚ AlphaGoã€TD-Gammon ç­‰")])]),t._v(" "),s("hr"),t._v(" "),s("blockquote",[s("p",[t._v("âœ… ä¸‹ä¸€ç« ï¼šé©¬å°”å¯å¤«è¿‡ç¨‹ï¼ˆMarkov Processesï¼‰å°†è¿›ä¸€æ­¥å½¢å¼åŒ–ä¸Šè¿°æ¦‚å¿µ")])]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("ğŸ“ æ³¨ï¼šä»¥ä¸Šå†…å®¹æ¥è‡ª Sutton & Bartoã€ŠReinforcement Learning: An Introductionã€‹ç¬¬äºŒç‰ˆç¬¬1ç« ä¸­æ–‡æ•´ç†ï¼ŒåŸæ–‡å›¾ç‰‡å·²é™„ã€‚")]),t._v(" "),s("h2",{attrs:{id:"implementation-of-tictactoe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#implementation-of-tictactoe"}},[t._v("#")]),t._v(" Implementation of tictactoe")]),t._v(" "),s("h1",{attrs:{id:"ğŸ¯-å­¦ä¹ ç›®æ ‡-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å­¦ä¹ ç›®æ ‡-2"}},[t._v("#")]),t._v(" ğŸ¯ å­¦ä¹ ç›®æ ‡")]),t._v(" "),s("ul",[s("li",[t._v("ç†è§£ Tic-Tac-Toe å¼ºåŒ–å­¦ä¹ ç¯å¢ƒçš„æ„å»ºæ–¹å¼")]),t._v(" "),s("li",[t._v("ç†è§£éšæœºç­–ç•¥ä¸ TD å­¦ä¹ æ›´æ–°ç­–ç•¥çš„å·®å¼‚")]),t._v(" "),s("li",[t._v("å­¦ä¼šå¦‚ä½•è®°å½•å¹¶ç»˜åˆ¶ TD Error çš„ç§»åŠ¨å¹³å‡å›¾")]),t._v(" "),s("li",[t._v("æŒæ¡ "),s("code",[t._v("defaultdict")]),t._v(", "),s("code",[t._v("torch")]),t._v(", "),s("code",[t._v("matplotlib")]),t._v(", "),s("code",[t._v("random")]),t._v(" ç­‰åŸºç¡€å·¥å…·åœ¨ RL ä¸­çš„ç”¨æ³•")])]),t._v(" "),s("hr"),t._v(" "),s("h1",{attrs:{id:"ğŸ”-å¼•å¯¼é—®é¢˜ä¸apiè¯´æ˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-å¼•å¯¼é—®é¢˜ä¸apiè¯´æ˜"}},[t._v("#")]),t._v(" ğŸ” å¼•å¯¼é—®é¢˜ä¸APIè¯´æ˜")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("åŠŸèƒ½")]),t._v(" "),s("th",[t._v("æè¿°")]),t._v(" "),s("th",[t._v("ç¤ºä¾‹è¾“å…¥")]),t._v(" "),s("th",[t._v("ç¤ºä¾‹è¾“å‡º")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("one_round")])]),t._v(" "),s("td",[t._v("ä¸€æ¬¡å‡ºæ‰‹ï¼Œå…ˆOå†X")]),t._v(" "),s("td",[t._v("å½“å‰çŠ¶æ€+ç©ºæ ¼ç´¢å¼•")]),t._v(" "),s("td",[t._v("è·èƒœæ–¹æˆ–NOWIN")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("check_win")])]),t._v(" "),s("td",[t._v("æ£€æŸ¥å½“å‰æ£‹ç›˜æ˜¯å¦æœ‰èƒœæ–¹")]),t._v(" "),s("td",[t._v("æ£‹ç›˜çŠ¶æ€")]),t._v(" "),s("td",[t._v("'X' / 'O' / 'NOWIN'")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("full_game")])]),t._v(" "),s("td",[t._v("è¿›è¡Œå®Œæ•´ä¸€å±€æ¸¸æˆï¼ˆæœ€å¤š4è½®ï¼‰")]),t._v(" "),s("td",[t._v("æ— ")]),t._v(" "),s("td",[t._v("è·èƒœæ–¹æˆ–NOWIN")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("update_policy_dict")])]),t._v(" "),s("td",[t._v("æ ¹æ®å½“å‰episodeæ›´æ–°æ‰€æœ‰stateçš„ä»·å€¼")]),t._v(" "),s("td",[t._v("èƒœè€…ã€çŠ¶æ€å†å²ã€ç­–ç•¥è¡¨")]),t._v(" "),s("td",[t._v("æ›´æ–°åçš„ç­–ç•¥å’ŒTDè¯¯å·®")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("calculate_win_rate")])]),t._v(" "),s("td",[t._v("è®­ç»ƒNè½®æ¸¸æˆå¹¶è®°å½•ç»“æœå’ŒTDè¯¯å·®")]),t._v(" "),s("td",[t._v("è®­ç»ƒè½®æ•°")]),t._v(" "),s("td",[t._v("èƒœç‡+è¯¯å·®æ—¥å¿—")])])])]),t._v(" "),s("hr"),t._v(" "),s("h1",{attrs:{id:"ğŸ§ª-leetcode-é£æ ¼ç»ƒä¹ é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-leetcode-é£æ ¼ç»ƒä¹ é¢˜"}},[t._v("#")]),t._v(" ğŸ§ª LeetCode é£æ ¼ç»ƒä¹ é¢˜")]),t._v(" "),s("h2",{attrs:{id:"é¢˜ç›®ä¸€-å®ç°-full-game-å‡½æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é¢˜ç›®ä¸€-å®ç°-full-game-å‡½æ•°"}},[t._v("#")]),t._v(" é¢˜ç›®ä¸€ï¼šå®ç° "),s("code",[t._v("full_game()")]),t._v(" å‡½æ•°")]),t._v(" "),s("h3",{attrs:{id:"âœ…-ç¤ºä¾‹è¾“å…¥è¾“å‡º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-ç¤ºä¾‹è¾“å…¥è¾“å‡º"}},[t._v("#")]),t._v(" âœ… ç¤ºä¾‹è¾“å…¥è¾“å‡ºï¼š")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" full_game"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"ğŸ“Œ-å‡½æ•°å®šä¹‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Œ-å‡½æ•°å®šä¹‰"}},[t._v("#")]),t._v(" ğŸ“Œ å‡½æ•°å®šä¹‰ï¼š")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("full_game")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"âœ…-æ–­è¨€æµ‹è¯•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-æ–­è¨€æµ‹è¯•"}},[t._v("#")]),t._v(" âœ… æ–­è¨€æµ‹è¯•ï¼š")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" full_game"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOWIN'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("hr"),t._v(" "),s("h1",{attrs:{id:"ğŸ§ª-éšæœºç­–ç•¥å®ç°-baseline"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-éšæœºç­–ç•¥å®ç°-baseline"}},[t._v("#")]),t._v(" ğŸ§ª éšæœºç­–ç•¥å®ç°ï¼ˆbaselineï¼‰")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" random\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" collections "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" defaultdict\n\nno_win_key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NOWIN"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("print_state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-----------"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-----------"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("one_round")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    o_pos_idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    o_pos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("o_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("o_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),t._v("\n    win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" check_win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" no_win_key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" win\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("del")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("o_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    x_pos_idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    x_pos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("del")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" check_win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" no_win_key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" win\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" no_win_key\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("check_win")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_round"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" final_round"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),t._v("\n    win_pos_lst "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" win_pos "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" win_pos_lst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"X"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"O"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOWIN'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("full_game")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    cur_arr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" one_round"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" no_win_key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" win\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" check_win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_round"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculate_win_rate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" defaultdict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("full_game"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res\n\nres "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" calculate_win_rate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# defaultdict(<class 'int'>, {'O': 581, 'X': 309, 'NOWIN': 110})")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br"),s("span",{staticClass:"line-number"},[t._v("57")]),s("br"),s("span",{staticClass:"line-number"},[t._v("58")]),s("br"),s("span",{staticClass:"line-number"},[t._v("59")]),s("br"),s("span",{staticClass:"line-number"},[t._v("60")]),s("br")])]),s("hr"),t._v(" "),s("h1",{attrs:{id:"ğŸ§ -åŸºäºå¼ºåŒ–å­¦ä¹ -td-æ›´æ–°-çš„ç­–ç•¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -åŸºäºå¼ºåŒ–å­¦ä¹ -td-æ›´æ–°-çš„ç­–ç•¥"}},[t._v("#")]),t._v(" ğŸ§  åŸºäºå¼ºåŒ–å­¦ä¹ ï¼ˆTD æ›´æ–°ï¼‰çš„ç­–ç•¥")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" math\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" random\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" collections "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" defaultdict\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" numpy "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" np\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" torch\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("functional "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" F\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" matplotlib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pyplot "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" plt\n\nno_win_key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NOWIN"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("print_state")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-----------"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"|"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-----------"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_x_pos_idx")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    candidate_prob_lst "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" idx "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        x_pos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        next_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        next_state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"X"')]),t._v("\n        state_str "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("next_state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        prob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state_str"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        candidate_prob_lst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    probs_tensor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("candidate_prob_lst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    top_idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argmax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("probs_tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" top_idx\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("one_round")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    o_pos_idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    o_pos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("o_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("o_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),t._v("\n    state_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" check_win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" no_win_key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("del")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("o_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    x_pos_idx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_x_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    x_pos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("del")]),t._v(" cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x_pos_idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    state_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" check_win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" no_win_key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" no_win_key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("check_win")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_round"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" final_round"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),t._v("\n    win_pos_lst "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" win_pos "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" win_pos_lst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"X"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win_pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"O"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOWIN'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("full_game")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    cur_arr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    state_history "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" one_round"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" no_win_key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" check_win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cur_arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_round"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("update_policy_dict")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" log_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    final_reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'O'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NOWIN'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    prev_reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" final_reward\n    td_err_lst "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" state "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("reversed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        td_err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" prev_reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" td_err\n        td_err_lst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("td_err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        prev_reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    log_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'td_err'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("td_err_lst"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" log_dict\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculate_win_rate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rounds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" defaultdict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" policy_dict "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        policy_dict "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" defaultdict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    log_dict "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" defaultdict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rounds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" full_game"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" log_dict "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" update_policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" policy_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" log_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" log_dict\n\nrounds "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\nres"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" log_dict "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" calculate_win_rate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rounds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# defaultdict(<class 'int'>, {'O': 283, 'X': 585, 'NOWIN': 132})")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br"),s("span",{staticClass:"line-number"},[t._v("57")]),s("br"),s("span",{staticClass:"line-number"},[t._v("58")]),s("br"),s("span",{staticClass:"line-number"},[t._v("59")]),s("br"),s("span",{staticClass:"line-number"},[t._v("60")]),s("br"),s("span",{staticClass:"line-number"},[t._v("61")]),s("br"),s("span",{staticClass:"line-number"},[t._v("62")]),s("br"),s("span",{staticClass:"line-number"},[t._v("63")]),s("br"),s("span",{staticClass:"line-number"},[t._v("64")]),s("br"),s("span",{staticClass:"line-number"},[t._v("65")]),s("br"),s("span",{staticClass:"line-number"},[t._v("66")]),s("br"),s("span",{staticClass:"line-number"},[t._v("67")]),s("br"),s("span",{staticClass:"line-number"},[t._v("68")]),s("br"),s("span",{staticClass:"line-number"},[t._v("69")]),s("br"),s("span",{staticClass:"line-number"},[t._v("70")]),s("br"),s("span",{staticClass:"line-number"},[t._v("71")]),s("br"),s("span",{staticClass:"line-number"},[t._v("72")]),s("br"),s("span",{staticClass:"line-number"},[t._v("73")]),s("br"),s("span",{staticClass:"line-number"},[t._v("74")]),s("br"),s("span",{staticClass:"line-number"},[t._v("75")]),s("br"),s("span",{staticClass:"line-number"},[t._v("76")]),s("br"),s("span",{staticClass:"line-number"},[t._v("77")]),s("br"),s("span",{staticClass:"line-number"},[t._v("78")]),s("br"),s("span",{staticClass:"line-number"},[t._v("79")]),s("br"),s("span",{staticClass:"line-number"},[t._v("80")]),s("br"),s("span",{staticClass:"line-number"},[t._v("81")]),s("br"),s("span",{staticClass:"line-number"},[t._v("82")]),s("br"),s("span",{staticClass:"line-number"},[t._v("83")]),s("br"),s("span",{staticClass:"line-number"},[t._v("84")]),s("br"),s("span",{staticClass:"line-number"},[t._v("85")]),s("br"),s("span",{staticClass:"line-number"},[t._v("86")]),s("br"),s("span",{staticClass:"line-number"},[t._v("87")]),s("br"),s("span",{staticClass:"line-number"},[t._v("88")]),s("br"),s("span",{staticClass:"line-number"},[t._v("89")]),s("br"),s("span",{staticClass:"line-number"},[t._v("90")]),s("br"),s("span",{staticClass:"line-number"},[t._v("91")]),s("br"),s("span",{staticClass:"line-number"},[t._v("92")]),s("br"),s("span",{staticClass:"line-number"},[t._v("93")]),s("br"),s("span",{staticClass:"line-number"},[t._v("94")]),s("br"),s("span",{staticClass:"line-number"},[t._v("95")]),s("br"),s("span",{staticClass:"line-number"},[t._v("96")]),s("br"),s("span",{staticClass:"line-number"},[t._v("97")]),s("br"),s("span",{staticClass:"line-number"},[t._v("98")]),s("br"),s("span",{staticClass:"line-number"},[t._v("99")]),s("br")])]),s("hr"),t._v(" "),s("h1",{attrs:{id:"ğŸ“ˆ-td-error-scatter-plot-moving-average"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“ˆ-td-error-scatter-plot-moving-average"}},[t._v("#")]),t._v(" ğŸ“ˆ TD Error Scatter Plot + Moving Average")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("plot_loss")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("moving_average")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" window_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("convolve"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ones"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window_size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("window_size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'valid'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    td_err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" log_dict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'td_err'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    ma_td_err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" moving_average"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("td_err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" window_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("figure"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("figsize"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scatter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rounds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" td_err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" s"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" alpha"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" label"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TD Error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ma_td_err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ma_td_err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" color"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'red'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" label"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Moving Avg (20)'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xlabel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Episode"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ylabel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TD Error"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TD Error Scatter and Moving Average"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("legend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("grid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tight_layout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("show"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nplot_loss"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("hr"),t._v(" "),s("h1",{attrs:{id:"ğŸ“·-td-error-å¯è§†åŒ–ç¤ºæ„å›¾"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“·-td-error-å¯è§†åŒ–ç¤ºæ„å›¾"}},[t._v("#")]),t._v(" ğŸ“· TD Error å¯è§†åŒ–ç¤ºæ„å›¾")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/emmableu/image/master/202507011126365.png",alt:""}})]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("âœ… "),s("strong",[t._v("ä¸‹ä¸€æ­¥å»ºè®®")]),t._v("ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¢åŠ  epsilon-greedy ç­–ç•¥è¿›è¡Œæ¢ç´¢")]),t._v(" "),s("li",[t._v("å®ç° softmax ç­–ç•¥åˆ†å¸ƒé‡‡æ ·ä»£æ›¿è´ªå©ª")]),t._v(" "),s("li",[t._v("å°è¯•ç”¨ JAX é‡æ–°å®ç°ç­–ç•¥æ›´æ–°")])])])}),[],!1,null,null,null);s.default=r.exports}}]);