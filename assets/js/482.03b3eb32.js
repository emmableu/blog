(window.webpackJsonp=window.webpackJsonp||[]).push([[482],{854:function(t,s,a){"use strict";a.r(s);var n=a(9),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"🧠-pytorch-中的-f-one-hot-详解-问答式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🧠-pytorch-中的-f-one-hot-详解-问答式"}},[t._v("#")]),t._v(" 🧠 PyTorch 中的 "),s("code",[t._v("F.one_hot()")]),t._v(" 详解（问答式）")]),t._v(" "),s("h2",{attrs:{id:"🎯-q1-什么是-f-one-hot"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🎯-q1-什么是-f-one-hot"}},[t._v("#")]),t._v(" 🎯 Q1: 什么是 "),s("code",[t._v("F.one_hot()")]),t._v("？")]),t._v(" "),s("p",[s("strong",[t._v("答：")]),s("br"),t._v(" "),s("code",[t._v("F.one_hot()")]),t._v(" 是 PyTorch 中用于将 "),s("strong",[t._v("整数标签转为独热编码（one-hot vectors）")]),t._v(" 的函数。")]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"🧪-q2-示例-最基本的一维输入是怎样的"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🧪-q2-示例-最基本的一维输入是怎样的"}},[t._v("#")]),t._v(" 🧪 Q2: 示例：最基本的一维输入是怎样的？")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" torch\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("functional "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" F\n\nX "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\none_hot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" F"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("one_hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" num_classes"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("one_hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[s("strong",[t._v("输出：")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("tensor([[1, 0, 0, 0],\n        [0, 1, 0, 0],\n        [0, 0, 1, 0]])\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[s("strong",[t._v("解释：")])]),t._v(" "),s("ul",[s("li",[t._v("输入是 "),s("code",[t._v("[0, 1, 2]")]),t._v("，表示有三个类别编号。")]),t._v(" "),s("li",[s("code",[t._v("num_classes=4")]),t._v(" 明确告诉函数我们有 4 类（0~3），所以每个输出向量长度是 4。")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"🧪-q3-如果输入是-2d-的呢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🧪-q3-如果输入是-2d-的呢"}},[t._v("#")]),t._v(" 🧪 Q3: 如果输入是 2D 的呢？")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("X "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\none_hot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" F"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("one_hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" num_classes"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("one_hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[s("strong",[t._v("输出：")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("tensor([[[0, 1, 0, 0],\n         [0, 0, 1, 0]],\n\n        [[1, 0, 0, 0],\n         [0, 0, 0, 1]]])\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[s("strong",[t._v("解释：")])]),t._v(" "),s("ul",[s("li",[t._v("原输入 shape 是 "),s("code",[t._v("(2, 2)")]),t._v("，每个数字代表一个类别")]),t._v(" "),s("li",[t._v("结果 shape 是 "),s("code",[t._v("(2, 2, 4)")]),t._v("，每个类别转成了一个 one-hot 向量")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"🧪-q4-为什么要用-f-one-hot"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🧪-q4-为什么要用-f-one-hot"}},[t._v("#")]),t._v(" 🧪 Q4: 为什么要用 "),s("code",[t._v("F.one_hot()")]),t._v("？")]),t._v(" "),s("p",[s("strong",[t._v("答：")]),s("br"),t._v("\n因为很多模型（比如神经网络）不能直接处理整数标签，而需要将其转换成向量形式，one-hot 是最常见的方式之一。常用于：")]),t._v(" "),s("ul",[s("li",[t._v("文本中的词表示")]),t._v(" "),s("li",[t._v("分类模型的输入/标签")]),t._v(" "),s("li",[t._v("构造 embedding 输入之前的预处理")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"🧪-q5-用在-bigram-的例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🧪-q5-用在-bigram-的例子"}},[t._v("#")]),t._v(" 🧪 Q5: 用在 bigram 的例子？")]),t._v(" "),s("p",[t._v("假设我们把字符对 ("),s("code",[t._v(".")]),t._v(", "),s("code",[t._v("a")]),t._v(") 映射成一个整数索引：")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("X "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 假设 0=".a", 1="ab", 2="bc"')]),t._v("\none_hot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" F"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("one_hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" num_classes"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("one_hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[s("strong",[t._v("输出：")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("torch.Size([3, 729])\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("hr"),t._v(" "),s("h2",{attrs:{id:"🧠-总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🧠-总结"}},[t._v("#")]),t._v(" 🧠 总结")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("操作")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("F.one_hot(X, n)")])]),t._v(" "),s("td",[t._v("将整型张量 "),s("code",[t._v("X")]),t._v(" 转成 one-hot 向量，维度长度为 "),s("code",[t._v("n")])])]),t._v(" "),s("tr",[s("td",[t._v("支持多维输入")]),t._v(" "),s("td",[t._v("自动扩展为 shape + [num_classes]")])]),t._v(" "),s("tr",[s("td",[t._v("常用于输入预处理")]),t._v(" "),s("td",[t._v("如字符对、词对、分类输入等")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);