(window.webpackJsonp=window.webpackJsonp||[]).push([[477],{849:function(t,s,a){"use strict";a.r(s);var n=a(9),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ç¬¬2ç« -å¤šè‡‚æ··æ··æœºé—®é¢˜-multi-arm-bandits"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬2ç« -å¤šè‡‚æ··æ··æœºé—®é¢˜-multi-arm-bandits"}},[t._v("#")]),t._v(" ç¬¬2ç«  å¤šè‡‚æ··æ··æœºé—®é¢˜ (Multi-Arm Bandits)")]),t._v(" "),s("h2",{attrs:{id:"åŸºæœ¬æ¦‚å¿µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬æ¦‚å¿µ"}},[t._v("#")]),t._v(" åŸºæœ¬æ¦‚å¿µ")]),t._v(" "),s("p",[t._v("å¼ºåŒ–å­¦ä¹ ä¸å…¶ä»–ç±»å‹å­¦ä¹ æœ€é‡è¦çš„åŒºåˆ«æ˜¯ï¼šå®ƒä½¿ç”¨â€œ"),s("strong",[t._v("è¯„ä¼°å¼åé¦ˆ")]),t._v("â€è€Œéâ€œæŒ‡ç¤ºå¼åé¦ˆâ€ã€‚")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("è¯„ä¼°å¼åé¦ˆ")]),t._v("ï¼šåªå‘Šè¯‰ä½ é€‰çš„è¿™ä¸ªåŠ¨ä½œâ€œå¥½ä¸å¥½â€ï¼Œä½†ä¸å‘Šè¯‰ä½ æ˜¯ä¸æ˜¯æœ€å¥½çš„")]),t._v(" "),s("li",[s("strong",[t._v("æŒ‡ç¤ºå¼åé¦ˆ")]),t._v("ï¼šæ˜ç¡®æŒ‡å‡ºå“ªä¸ªåŠ¨ä½œæ˜¯æ­£ç¡®çš„ï¼Œä¸æ˜¯å¦æ‰§è¡Œæ— å…³")])]),t._v(" "),s("h1",{attrs:{id:"_2-1-n-è‡‚æ··æ··æœºé—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-n-è‡‚æ··æ··æœºé—®é¢˜"}},[t._v("#")]),t._v(" 2.1 $n$ è‡‚æ··æ··æœºé—®é¢˜")]),t._v(" "),s("ul",[s("li",[t._v("æ¯æ¬¡ä» $n$ ä¸ªåŠ¨ä½œä¸­é€‰æ‹©ä¸€ä¸ª")]),t._v(" "),s("li",[t._v("æ¯ä¸ªåŠ¨ä½œå¯¹åº”ä¸€ä¸ªå›ºå®šä½†æœªçŸ¥çš„å¥–åŠ±åˆ†å¸ƒ")]),t._v(" "),s("li",[t._v("ç›®æ ‡æ˜¯æœ€å¤§åŒ–æœªæ¥è‹¥å¹²æ­¥å†…çš„ç´¯è®¡æœŸæœ›å¥–åŠ±ï¼Œä¾‹å¦‚ 1000 æ­¥å†…")])]),t._v(" "),s("p",[t._v("è¯·è€ƒè™‘ä»¥ä¸‹å­¦ä¹ é—®é¢˜ï¼š"),s("br"),t._v("\nä½ åå¤é¢ä¸´ä»å¤šä¸ªä¸åŒé€‰é¡¹ï¼ˆæˆ–åŠ¨ä½œï¼‰ä¸­è¿›è¡Œé€‰æ‹©çš„é—®é¢˜ã€‚æ¯æ¬¡é€‰æ‹©åï¼Œä½ ä¼šæ”¶åˆ°ä¸€ä¸ªæ ¹æ®æ‰€é€‰åŠ¨ä½œçš„"),s("strong",[t._v("å›ºå®šæ¦‚ç‡åˆ†å¸ƒ")]),t._v("ç”Ÿæˆçš„"),s("strong",[t._v("æ•°å€¼å¥–åŠ±")]),t._v("ã€‚"),s("br"),t._v("\nä½ çš„ç›®æ ‡æ˜¯ï¼š"),s("strong",[t._v("æœ€å¤§åŒ–æŸä¸€æ—¶é—´æ®µå†…çš„æœŸæœ›æ€»å¥–åŠ±")]),t._v("ï¼Œä¾‹å¦‚åœ¨ 1000 æ¬¡åŠ¨ä½œé€‰æ‹©æˆ–æ—¶é—´æ­¥å†…ã€‚")]),t._v(" "),s("p",[t._v("è¿™å°±æ˜¯è‘—åçš„ "),s("strong",[t._v("n è‡‚è€è™æœºé—®é¢˜ï¼ˆn-armed bandit problemï¼‰")]),t._v(" çš„åŸå§‹å½¢å¼ã€‚å…¶åç§°æ¥æºäºè€è™æœºâ€”â€”åˆç§°ä¸ºâ€œå•è‡‚å¼ºç›—ï¼ˆone-armed banditï¼‰â€ï¼Œä¸è¿‡å®ƒæ‹¥æœ‰ n ä¸ªæ‹‰æ†ï¼Œè€Œéä¸€ä¸ªã€‚")]),t._v(" "),s("p",[t._v("æ¯ä¸€ä¸ªåŠ¨ä½œé€‰æ‹©å°±åƒæ˜¯åœ¨è€è™æœºä¸Šæ‹‰ä¸€æ¬¡æ‹‰æ†ï¼Œè€Œå¥–åŠ±å°±æ˜¯å‘½ä¸­â€œå¤´å¥–â€åçš„æ”¶ç›Šã€‚"),s("br"),t._v("\né€šè¿‡å¤šæ¬¡é‡å¤çš„é€‰æ‹©ï¼Œä½ å¸Œæœ›é€šè¿‡é›†ä¸­é€‰æ‹©æŸäº›æ‹‰æ†æ¥æœ€å¤§åŒ–ä½ çš„ç›ˆåˆ©ã€‚å¦ä¸€ç§ç±»æ¯”æ˜¯åŒ»ç”Ÿä¸ºå¤šä½é‡ç—…æ‚£è€…é€‰æ‹©æ²»ç–—æ–¹æ¡ˆï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªæ²»ç–—æ‰‹æ®µï¼Œè€Œæ¯æ¬¡çš„â€œå¥–åŠ±â€å°±æ˜¯è¯¥æ‚£è€…çš„åº·å¤ç¨‹åº¦ã€‚ä»Šå¤©ï¼Œâ€œn è‡‚è€è™æœºé—®é¢˜â€è¿™ä¸ªæœ¯è¯­é€šå¸¸æ³›æŒ‡æ­¤ç±»é—®é¢˜çš„æ¨å¹¿å½¢å¼ï¼Œä½†åœ¨æœ¬ä¹¦ä¸­æˆ‘ä»¬ä¸“æŒ‡æ­¤ç§å½¢å¼ã€‚")]),t._v(" "),s("p",[t._v("åœ¨æˆ‘ä»¬çš„ n è‡‚è€è™æœºé—®é¢˜ä¸­ï¼Œ"),s("strong",[t._v("æ¯ä¸ªåŠ¨ä½œéƒ½æœ‰ä¸€ä¸ªæœŸæœ›å¥–åŠ±ï¼ˆmean rewardï¼‰")]),t._v("ï¼Œå‡è®¾æˆ‘ä»¬å°†æŸä¸€åŠ¨ä½œçš„æœŸæœ›å¥–åŠ±ç§°ä½œè¯¥åŠ¨ä½œçš„â€œå€¼ï¼ˆvalueï¼‰â€ã€‚"),s("br"),t._v("\nè‹¥ä½ çŸ¥é“æ¯ä¸ªåŠ¨ä½œçš„å€¼ï¼Œé‚£ä¹ˆè§£å†³è¯¥é—®é¢˜æ˜¯éå¸¸ç®€å•çš„ï¼šä½ æ€»æ˜¯é€‰æ‹©å€¼æœ€å¤§çš„åŠ¨ä½œå³å¯ã€‚"),s("br"),t._v("\nä½†ç°å®ä¸­æˆ‘ä»¬å¹¶ä¸çŸ¥é“å„åŠ¨ä½œçš„å€¼ï¼Œæˆ‘ä»¬åªèƒ½é€æ­¥ä¼°è®¡å®ƒä»¬ã€‚")]),t._v(" "),s("p",[t._v("å› æ­¤ï¼Œè‹¥ä½ åœ¨æŸä¸€æ—¶åˆ»ä¼°è®¡çš„åŠ¨ä½œå€¼ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªçš„ä¼°å€¼æœ€å¤§ï¼Œé‚£ä¹ˆé€‰æ‹©å®ƒå³æ˜¯ä¸€ä¸ª"),s("strong",[t._v("è´ªå©ªåŠ¨ä½œï¼ˆgreedy actionï¼‰")]),t._v("ã€‚å¦‚æœä½ é€‰æ‹©è¿™æ ·çš„åŠ¨ä½œï¼Œå³è¯´æ˜ä½ æ­£åœ¨**åˆ©ç”¨ï¼ˆexploitingï¼‰**ä½ å¯¹å½“å‰åŠ¨ä½œå€¼çš„å·²æœ‰çŸ¥è¯†ã€‚")]),t._v(" "),s("p",[t._v("åä¹‹ï¼Œè‹¥ä½ é€‰æ‹©äº†ä¸€ä¸ªéè´ªå©ªçš„åŠ¨ä½œï¼Œå³è¯´æ˜ä½ æ­£åœ¨"),s("strong",[t._v("æ¢ç´¢ï¼ˆexploringï¼‰")]),t._v("ï¼Œä»¥å°è¯•è·å¾—å¯¹è¯¥åŠ¨ä½œå€¼çš„æ›´å¥½ä¼°è®¡ã€‚åˆ©ç”¨æ˜¯ä»å½“å‰è§’åº¦æ¥çœ‹æœ€ä¼˜çš„é€‰æ‹©ï¼Œä½†æ¢ç´¢å¯èƒ½å¸¦æ¥æ›´å¤§çš„é•¿æœŸæ”¶ç›Šã€‚"),s("br"),t._v("\nä¸¾ä¾‹æ¥è¯´ï¼šå‡è®¾è´ªå©ªåŠ¨ä½œçš„å€¼æ˜¯å·²çŸ¥ä¸”ç¡®å®šçš„ï¼Œè€Œå¦ä¸€äº›åŠ¨ä½œçš„ä¼°å€¼æ¥è¿‘ï¼Œä½†ä¸ç¡®å®šæ€§å¾ˆå¤§ã€‚é‚£ä¹ˆè‡³å°‘æœ‰ä¸€ä¸ªéè´ªå©ªåŠ¨ä½œå¯èƒ½å®é™…ä¸Šæ¯”è´ªå©ªåŠ¨ä½œæ›´ä¼˜ï¼Œä½†ä½ å¹¶ä¸çŸ¥é“å“ªä¸€ä¸ªã€‚å› æ­¤å¦‚æœä½ æœ‰è¶³å¤Ÿå¤šçš„æ—¶é—´æ­¥ç”¨äºåšé€‰æ‹©ï¼Œé‚£ä¹ˆæ¢ç´¢è¿™äº›ä¸ç¡®å®šçš„åŠ¨ä½œå¹¶æ‰¾å‡ºæ›´ä¼˜çš„é€‰æ‹©å¯èƒ½æ›´æœ‰åˆ©ã€‚")]),t._v(" "),s("p",[t._v("çŸ­æœŸæ¥çœ‹æ¢ç´¢å¸¦æ¥çš„å¥–åŠ±å¯èƒ½è¾ƒä½ï¼Œä½†é•¿æœŸæ¥çœ‹ï¼Œç”±äºå‘ç°äº†æ›´ä¼˜çš„é€‰æ‹©ï¼Œä½ å¯èƒ½è·å¾—æ›´å¤§çš„æ”¶ç›Šã€‚"),s("br"),t._v("\nç”±äºæ— æ³•åœ¨å•æ¬¡é€‰æ‹©ä¸­æ—¢æ¢ç´¢åˆåˆ©ç”¨ï¼Œå› æ­¤â€œæ¢ç´¢ vs åˆ©ç”¨â€çš„**å†²çªï¼ˆconflictï¼‰**æˆä¸ºå¼ºåŒ–å­¦ä¹ ä¸­ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ã€‚")]),t._v(" "),s("p",[t._v("åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹ï¼Œæ˜¯å¦è¯¥æ¢ç´¢æˆ–åˆ©ç”¨ä¾èµ–äºä¼°å€¼çš„å‡†ç¡®æ€§ã€ä¸ç¡®å®šæ€§ã€å‰©ä½™æ—¶é—´æ­¥æ•°ç­‰å› ç´ çš„å¤æ‚ç»„åˆã€‚"),s("br"),t._v("\nè™½ç„¶å­˜åœ¨å¾ˆå¤šæ–¹æ³•å¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨ï¼Œä¾‹å¦‚å¯¹ n è‡‚è€è™æœºé—®é¢˜å’Œå…¶æ¨å¹¿é—®é¢˜çš„æ•°å­¦å½¢å¼è¿›è¡Œä¼˜åŒ–ï¼Œä½†å¤§å¤šæ•°æ–¹æ³•å‡è®¾ç¯å¢ƒæ˜¯"),s("strong",[t._v("å¹³ç¨³çš„ï¼ˆstationaryï¼‰"),s("strong",[t._v("ä¸”äº‹å…ˆ")]),t._v("å¯çŸ¥çš„")]),t._v("ï¼Œè¿™åœ¨ç°å®ä¸–ç•Œä¸­å¾€å¾€ä¸æˆç«‹ã€‚")]),t._v(" "),s("p",[t._v("æœ¬ä¹¦ä¸ä¼šä»è¿‡äºå¤æ‚çš„è§’åº¦æ¥ç ”ç©¶å¦‚ä½•å¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨ã€‚æˆ‘ä»¬ç”šè‡³"),s("strong",[t._v("ä¸ä¼šè¿‡åˆ†æ‹…å¿ƒè¿™ç§å¹³è¡¡")]),t._v("ï¼Œè€Œæ˜¯é‡ç‚¹ä»‹ç»å‡ ç§ç®€å•æœ‰æ•ˆçš„ç­–ç•¥ã€‚è¿™äº›æ–¹æ³•è¿œä¼˜äºåªåˆ©ç”¨ã€æ°¸è¿œé€‰æ‹©å½“å‰æœ€ä¼˜åŠ¨ä½œçš„æ–¹æ³•ã€‚æ¢ç´¢ä¸åˆ©ç”¨çš„å¹³è¡¡æ˜¯å¼ºåŒ–å­¦ä¹ çš„å…¸å‹æŒ‘æˆ˜ï¼Œè€Œ n è‡‚è€è™æœºçš„ç®€å•è®¾ç½®ä½¿æˆ‘ä»¬èƒ½åœ¨æ¸…æ™°çš„æ¡†æ¶ä¸­å±•ç°è¿™ä¸€æŒ‘æˆ˜ã€‚")]),t._v(" "),s("hr"),t._v(" "),s("h1",{attrs:{id:"_2-2-åŠ¨ä½œä»·å€¼æ–¹æ³•-action-value-methods-ä¸-Îµ-greedy-ç­–ç•¥è¯¦è§£"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-åŠ¨ä½œä»·å€¼æ–¹æ³•-action-value-methods-ä¸-Îµ-greedy-ç­–ç•¥è¯¦è§£"}},[t._v("#")]),t._v(" 2.2 åŠ¨ä½œä»·å€¼æ–¹æ³•ï¼ˆAction-Value Methodsï¼‰ä¸ Îµ-greedy ç­–ç•¥è¯¦è§£")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ›´æ·±å…¥åœ°ç ”ç©¶ä¸€äº›**ä¼°è®¡åŠ¨ä½œå€¼ï¼ˆvalueï¼‰**çš„ç®€å•æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨è¿™äº›ä¼°è®¡å€¼æ¥æŒ‡å¯¼åŠ¨ä½œé€‰æ‹©å†³ç­–ã€‚")]),t._v(" "),s("p",[t._v("åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ç”¨ $Q_t(a)$ æ¥è¡¨ç¤ºç¬¬ $t$ æ­¥æ—¶å¯¹åŠ¨ä½œ $a$ çš„å€¼ï¼ˆå³å¹³å‡å¥–åŠ±ï¼‰çš„ä¼°è®¡ã€‚"),s("br"),t._v("\nçœŸå®åŠ¨ä½œå€¼æ˜¯æ‰§è¡Œè¯¥åŠ¨ä½œæ—¶è·å¾—çš„æœŸæœ›å¥–åŠ±ï¼Œè€Œä¼°è®¡å€¼å°±æ˜¯å¯¹è¯¥æœŸæœ›çš„è¿‘ä¼¼ã€‚")]),t._v(" "),s("p",[t._v("ä¸€ç§è‡ªç„¶çš„ä¼°è®¡æ–¹æ³•æ˜¯å–æ¯æ¬¡é€‰æ‹©è¯¥åŠ¨ä½œæ—¶è·å¾—çš„å®é™…å¥–åŠ±çš„å¹³å‡å€¼ã€‚")]),t._v(" "),s("p",[t._v("æ¢å¥è¯è¯´ï¼Œè‹¥åœ¨ç¬¬ $t$ æ­¥ä¹‹å‰ï¼ŒåŠ¨ä½œ $a$ è¢«é€‰æ‹©äº† $N_t(a)$ æ¬¡ï¼Œè·å¾—äº†å¥–åŠ± $R_1, R_2, ..., R_{N_t(a)}$ï¼Œé‚£ä¹ˆå¯¹åŠ¨ä½œ $a$ çš„å€¼ä¼°è®¡ä¸ºï¼š")]),t._v(" "),s("p",[t._v("$$\nQ_t(a) = \\frac{R_1 + R_2 + \\cdots + R_{N_t(a)}}{N_t(a)} \\tag{2.1}\n$$")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"âœ…-ç­‰ä»·é€’æ¨æ›´æ–°å…¬å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-ç­‰ä»·é€’æ¨æ›´æ–°å…¬å¼"}},[t._v("#")]),t._v(" âœ… ç­‰ä»·é€’æ¨æ›´æ–°å…¬å¼")]),t._v(" "),s("p",[t._v("åœ¨å®é™…å®ç°ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ¯æ¬¡é‡æ–°éå†æ‰€æœ‰è¿‡å»çš„å¥–åŠ± $R_i$ æ¥è®¡ç®—å¹³å‡å€¼ï¼Œè€Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ª"),s("strong",[t._v("åœ¨çº¿æ›´æ–°å…¬å¼ï¼ˆincremental updateï¼‰")]),t._v("ï¼š")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("è¿™æ˜¯ "),s("strong",[t._v("å¼ (2.1)")]),t._v(" çš„é€’æ¨æ›´æ–°å½¢å¼ã€‚å®ƒå…è®¸æˆ‘ä»¬åœ¨æ¯æ¬¡æ”¶åˆ°æ–°å¥–åŠ±åï¼Œä»…ä½¿ç”¨å½“å‰ä¼°è®¡å€¼å’Œæ–°å¥–åŠ±æ¥æ›´æ–°ï¼Œä¸éœ€è¦ä¿å­˜æ‰€æœ‰å†å²æ•°æ®ã€‚")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ“˜-ä¸¾ä¾‹è¯´æ˜-ä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªå…¬å¼æ˜¯ç­‰ä»·çš„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“˜-ä¸¾ä¾‹è¯´æ˜-ä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªå…¬å¼æ˜¯ç­‰ä»·çš„"}},[t._v("#")]),t._v(" ğŸ“˜ ä¸¾ä¾‹è¯´æ˜ï¼šä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªå…¬å¼æ˜¯ç­‰ä»·çš„ï¼Ÿ")]),t._v(" "),s("h4",{attrs:{id:"ç¯å¢ƒè®¾å®š"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¯å¢ƒè®¾å®š"}},[t._v("#")]),t._v(" ç¯å¢ƒè®¾å®šï¼š")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬æœ‰3ä¸ªåŠ¨ä½œï¼Œæ¯ä¸ªåŠ¨ä½œçš„å¥–åŠ±æ˜¯å‡åŒ€åˆ†å¸ƒå¦‚ä¸‹ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("åŠ¨ä½œ")]),t._v(" "),s("th",[t._v("å¥–åŠ±åˆ†å¸ƒ")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("1")]),t._v(" "),s("td",[t._v("å‡åŒ€åˆ†å¸ƒäº [0, 1]")])]),t._v(" "),s("tr",[s("td",[t._v("2")]),t._v(" "),s("td",[t._v("å‡åŒ€åˆ†å¸ƒäº [0, 2]")])]),t._v(" "),s("tr",[s("td",[t._v("3")]),t._v(" "),s("td",[t._v("å‡åŒ€åˆ†å¸ƒäº [0, 3]")])])])]),t._v(" "),s("p",[t._v("ç°åœ¨ä¾æ¬¡é€‰æ‹©åŠ¨ä½œåºåˆ—ï¼š"),s("strong",[t._v("[1, 2, 2, 3]")])]),t._v(" "),s("h4",{attrs:{id:"ç¬¬ä¸€æ¬¡é€‰æ‹©åŠ¨ä½œ-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬ä¸€æ¬¡é€‰æ‹©åŠ¨ä½œ-2"}},[t._v("#")]),t._v(" ç¬¬ä¸€æ¬¡é€‰æ‹©åŠ¨ä½œ 2ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¥–åŠ±ï¼š"),s("code",[t._v("0.1")])]),t._v(" "),s("li",[t._v("æ›´æ–°æ¬¡æ•°ï¼š$N = 1$")]),t._v(" "),s("li",[t._v("åˆå§‹åŒ– $Q = 0$")])]),t._v(" "),s("p",[s("strong",[t._v("æ›´æ–°æ–¹å¼ä¸€ï¼ˆå¹³å‡å€¼ï¼‰ï¼š")]),t._v("\n$$\nQ_1(2) = \\frac{0.1}{1} = 0.1\n$$")]),t._v(" "),s("p",[s("strong",[t._v("æ›´æ–°æ–¹å¼äºŒï¼ˆé€’æ¨å…¬å¼ï¼‰ï¼š")])]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("âœ… ç»“æœä¸€è‡´")]),t._v(" "),s("h4",{attrs:{id:"ç¬¬äºŒæ¬¡é€‰æ‹©åŠ¨ä½œ-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬äºŒæ¬¡é€‰æ‹©åŠ¨ä½œ-2"}},[t._v("#")]),t._v(" ç¬¬äºŒæ¬¡é€‰æ‹©åŠ¨ä½œ 2ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¥–åŠ±ï¼š"),s("code",[t._v("0.9")])]),t._v(" "),s("li",[t._v("æ›´æ–°æ¬¡æ•°ï¼š$N = 2$")])]),t._v(" "),s("p",[s("strong",[t._v("æ›´æ–°æ–¹å¼ä¸€ï¼ˆå¹³å‡å€¼ï¼‰ï¼š")]),t._v("\n$$\nQ_2(2) = \\frac{0.1 + 0.9}{2} = 0.5\n$$")]),t._v(" "),s("p",[s("strong",[t._v("æ›´æ–°æ–¹å¼äºŒï¼ˆé€’æ¨å…¬å¼ï¼‰ï¼š")])]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("âœ… å†æ¬¡ä¸€è‡´")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"âœ¨-å°ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ¨-å°ç»“"}},[t._v("#")]),t._v(" âœ¨ å°ç»“")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æ–¹æ³•")]),t._v(" "),s("th",[t._v("è®¡ç®—æ–¹å¼")]),t._v(" "),s("th",[t._v("ä¼˜ç‚¹")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("å¹³å‡å…¬å¼ $Q_t(a) = \\frac{\\sum R_i}{N_t(a)}$")]),t._v(" "),s("td",[t._v("æ¯æ¬¡è®¡ç®—éœ€ä¿å­˜æ‰€æœ‰å†å²å¥–åŠ±")]),t._v(" "),s("td",[t._v("ç†è®ºç›´è§‚")])]),t._v(" "),s("tr",[s("td",[t._v("é€’æ¨å…¬å¼ $Q \\mathrel{+}= \\frac{\\text{reward} - Q}{N}$")]),t._v(" "),s("td",[t._v("æ¯æ¬¡åªéœ€å½“å‰å€¼å’Œæ¬¡æ•°")]),t._v(" "),s("td",[t._v("é«˜æ•ˆå®ç”¨ã€èŠ‚çœå†…å­˜")])])])]),t._v(" "),s("p",[t._v("âœ… ä¸¤è€…"),s("strong",[t._v("æ•°å­¦ä¸Šå®Œå…¨ç­‰ä»·")]),t._v("ï¼Œåè€…æ›´é€‚åˆå®é™…å¼ºåŒ–å­¦ä¹ ä¸­çš„å®ç°ï¼Œå°¤å…¶æ˜¯å¤„ç†å¤§è§„æ¨¡åŠ¨ä½œç©ºé—´æ—¶ã€‚")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("ğŸ“š ä½¿ç”¨ Sample Average çš„åŠ¨ä½œé€‰æ‹©æ–¹æ³•")]),t._v(" "),s("p",[t._v("å¦‚æœ $N_t(a) = 0$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®šä¹‰ $Q_1(a)$ ä¸ºæŸä¸ªé»˜è®¤å€¼ï¼Œä¾‹å¦‚ $Q_1(a) = 0$ã€‚éšç€ $N_t(a) \\to \\infty$ï¼Œæ ¹æ®å¤§æ•°å®šå¾‹ï¼Œ$Q_t(a)$ ä¼šæ”¶æ•›åˆ° $q(a)$ã€‚æˆ‘ä»¬å°†è¿™ç§æ–¹æ³•ç§°ä¸º sample-average methodï¼ˆæ ·æœ¬å‡å€¼æ³•ï¼‰ï¼Œå› ä¸ºæ¯æ¬¡ä¼°è®¡å€¼æ˜¯è¯¥åŠ¨ä½œç›¸å…³å¥–åŠ±çš„ç®€å•å¹³å‡ã€‚")]),t._v(" "),s("p",[t._v("å½“ç„¶è¿™åªæ˜¯ä¼—å¤šä¼°è®¡åŠ¨ä½œå€¼çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå¹¶éæœ€ä¼˜æ–¹æ³•ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬æš‚ä¸”ä»è¿™ä¸ªç®€å•æ–¹æ³•å¼€å§‹ï¼Œæ¥ä¸‹æ¥è®¨è®ºå¦‚ä½•ä½¿ç”¨è¿™äº›ä¼°è®¡å€¼æ¥é€‰æ‹©åŠ¨ä½œã€‚")]),t._v(" "),s("p",[t._v("ğŸ¤– è´ªå©ªä¸ Îµ-è´ªå©ªåŠ¨ä½œé€‰æ‹©ç­–ç•¥")]),t._v(" "),s("p",[t._v("æœ€ç®€å•çš„åŠ¨ä½œé€‰æ‹©ç­–ç•¥æ˜¯ï¼šé€‰æ‹©å½“å‰å…·æœ‰æœ€é«˜ä¼°è®¡å€¼çš„åŠ¨ä½œï¼ˆæˆ–ä¹‹ä¸€ï¼‰ã€‚ä¹Ÿå°±æ˜¯åœ¨ç¬¬ $t$ æ­¥é€‰æ‹©ï¼š")]),t._v(" "),s("p",[t._v("$$\nA_t = \\arg\\max_a Q_t(a) \\tag{2.2}\n$$")]),t._v(" "),s("p",[t._v("å…¶ä¸­ $\\arg\\max_a$ è¡¨ç¤ºåœ¨æ‰€æœ‰åŠ¨ä½œ $a$ ä¸­é€‰å–ä½¿å¾—è¡¨è¾¾å¼å–æœ€å¤§å€¼çš„åŠ¨ä½œï¼ˆå¦‚é‡å¹³å±€åˆ™éšæœºé€‰æ‹©ï¼‰ã€‚è¯¥ç­–ç•¥ç§°ä¸º è´ªå©ªç­–ç•¥ï¼ˆgreedy action selectionï¼‰ã€‚")]),t._v(" "),s("p",[t._v("è¿™ç§ç­–ç•¥å®Œå…¨åŸºäºå½“å‰çŸ¥è¯†åšå‡ºæœ€å¤§åŒ–é¢„æœŸå¥–åŠ±çš„é€‰æ‹©ï¼Œæ²¡æœ‰æ¢ç´¢å…¶ä»–çœ‹ä¼¼è¾ƒå·®ä½†å¯èƒ½å®é™…æ›´å¥½çš„åŠ¨ä½œã€‚")]),t._v(" "),s("p",[t._v("ä¸€ä¸ªæ›¿ä»£ç­–ç•¥æ˜¯ä½¿ç”¨ Îµ-è´ªå©ªæ–¹æ³•ï¼ˆÎµ-greedyï¼‰ï¼š\nâ€¢\tåœ¨ç»å¤§å¤šæ•°æ—¶é—´ï¼ˆæ¦‚ç‡ $1 - \\varepsilon$ï¼‰é€‰æ‹©å½“å‰ä¼°è®¡å€¼æœ€é«˜çš„åŠ¨ä½œ\nâ€¢\tåœ¨å°‘æ•°æ—¶é—´ï¼ˆæ¦‚ç‡ $\\varepsilon$ï¼‰éšæœºä»æ‰€æœ‰åŠ¨ä½œä¸­é€‰æ‹©ä¸€ä¸ª")]),t._v(" "),s("p",[t._v("è¿™ç§æ–¹å¼ä¼šç¡®ä¿æ¯ä¸ªåŠ¨ä½œæœ€ç»ˆéƒ½ä¼šè¢«é‡‡æ ·æ— ç©·æ¬¡ï¼Œä»è€Œæ»¡è¶³ $Q_t(a) \\to q(a)$ï¼Œå³ä¼°è®¡å€¼æœ€ç»ˆä¼šæ”¶æ•›åˆ°çœŸå®å€¼ã€‚")]),t._v(" "),s("p",[t._v("è¿™æ„å‘³ç€é€‰æ‹©æœ€ä¼˜åŠ¨ä½œçš„æ¦‚ç‡ä¹Ÿä¼šæ”¶æ•›åˆ°æ¥è¿‘ $1 - \\varepsilon$ï¼Œå³æ¥è¿‘ç¡®å®šæ€§ã€‚")]),t._v(" "),s("p",[t._v("è¿™äº›åªæ˜¯æ¸è¿‘æ€§è´¨ï¼Œå®é™…æ•ˆæœè¿˜éœ€å®è¯åˆ†æã€‚")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("ğŸ”¬ å®éªŒï¼šè´ªå©ª vs Îµ-è´ªå©ª ç­–ç•¥çš„è¡¨ç°")]),t._v(" "),s("p",[t._v("ä¸ºç²—ç•¥è¯„ä¼°è´ªå©ªä¸ Îµ-è´ªå©ªæ–¹æ³•çš„æ•ˆæœï¼Œæˆ‘ä»¬åœ¨ä¸€ç»„æµ‹è¯•é—®é¢˜ä¸Šè¿›è¡Œäº†å®éªŒï¼š\nâ€¢\tå…±è¿›è¡Œäº† 2000 æ¬¡å®éªŒï¼Œæ¯æ¬¡ä¸ºä¸€ä¸ª 10 è‡‚è€è™æœºä»»åŠ¡ï¼ˆ$n = 10$ï¼‰\nâ€¢\tæ¯ä¸ªåŠ¨ä½œçš„çœŸå®å€¼ $q_"),s("em",[t._v("(a)$ ä»å‡å€¼ä¸º 0ã€æ–¹å·®ä¸º 1 çš„æ­£æ€åˆ†å¸ƒä¸­æŠ½å–\nâ€¢\tæ¯ä¸€æ­¥æ‰§è¡Œä¸€ä¸ªé€‰æ‹©åŠ¨ä½œ $A_t$ï¼Œå…¶å¥–åŠ± $R_t$ï¼š\nâ€¢\tå‡å€¼ä¸º $q_")]),t._v("(A_t)$ï¼ŒåŠ ä¸Šå‡å€¼ä¸º 0ã€æ–¹å·®ä¸º 1 çš„å™ªå£°")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬æ¯”è¾ƒäº†ä¸‰ç§ç­–ç•¥ï¼š\nâ€¢\tè´ªå©ªï¼ˆÎµ = 0ï¼‰\nâ€¢\tÎµ-è´ªå©ªï¼ŒÎµ = 0.01\nâ€¢\tÎµ-è´ªå©ªï¼ŒÎµ = 0.1")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/emmableu/image/master/202507011442658.png",alt:""}}),t._v("\nğŸ“Š å›¾ 2.1 åˆ†æï¼ˆFigure 2.1ï¼‰")]),t._v(" "),s("p",[t._v("å›¾è¡¨æ˜¾ç¤ºäº†ä¸‰ç§ç­–ç•¥åœ¨ 1000 æ­¥ä»¥å†…çš„å¹³å‡è¡¨ç°ï¼ˆåœ¨ 2000 ä¸ªç‹¬ç«‹ä»»åŠ¡ä¸Šå–å¹³å‡ï¼‰ï¼š\nâ€¢\tä¸Šå›¾ï¼šå¹³å‡å¥–åŠ± vs æ­¥æ•°\nâ€¢\tä¸‹å›¾ï¼šé€‰æ‹©æœ€ä¼˜åŠ¨ä½œçš„æ¯”ä¾‹ vs æ­¥æ•°")]),t._v(" "),s("p",[t._v("è§‚å¯Ÿç»“è®ºï¼š\nâ€¢\tÎµ = 0.1 çš„ç­–ç•¥åœ¨é•¿æœŸè¡¨ç°ä¸Šæœ€ä¼˜ï¼š\nâ€¢\tå¹³å‡å¥–åŠ±æœ€é«˜\nâ€¢\tæœ€ä¼˜åŠ¨ä½œé€‰æ‹©ç‡ä¸Šå‡æœ€å¿«\nâ€¢\tÎµ = 0ï¼ˆè´ªå©ªç­–ç•¥ï¼‰è™½ä¸€å¼€å§‹è¡¨ç°å°šå¯ï¼Œä½†é•¿æœŸæ€§èƒ½æœ€å·®\nâ€¢\tåŸå› æ˜¯é™·å…¥äº†éæœ€ä¼˜é€‰æ‹©ï¼Œå› æœªæ¢ç´¢\nâ€¢\tÎµ = 0.01 è¡¨ç°ä»‹äºä¸¤è€…ä¹‹é—´")]),t._v(" "),s("p",[t._v("å°ç»“ï¼š æ·»åŠ é€‚é‡éšæœºæ€§å¯ä»¥æ˜¾è‘—æå‡å­¦ä¹ æ€§èƒ½ã€‚")]),t._v(" "),s("p",[t._v("ğŸ“Œ æ³¨ï¼š\nå›¾å½¢çš„åˆå§‹é˜¶æ®µå˜åŒ–å—å¤šä¸ªæœ€ä¼˜åŠ¨ä½œå€¼ç›¸åŒçš„å½±å“ï¼ˆæ­¤æ—¶ç³»ç»Ÿé‡‡ç”¨éšæœºæ‰“ç ´å¹³å±€ï¼‰ï¼Œä¹Ÿå¯é€šè¿‡åœ¨åˆå§‹åŠ¨ä½œå€¼ä¸­åŠ å…¥å¾®é‡éšæœºæ•°æ¥é¿å…è¯¥é—®é¢˜ã€‚")]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ§ -æ ·æœ¬å¹³å‡ä¸-Îµ-greedy-ä»£ç å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -æ ·æœ¬å¹³å‡ä¸-Îµ-greedy-ä»£ç å®ç°"}},[t._v("#")]),t._v(" ğŸ§  æ ·æœ¬å¹³å‡ä¸ Îµ-greedy ä»£ç å®ç°")]),t._v(" "),s("h3",{attrs:{id:"æ›´æ–°-q-å€¼-sample-average"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ›´æ–°-q-å€¼-sample-average"}},[t._v("#")]),t._v(" æ›´æ–° Q å€¼ï¼ˆsample averageï¼‰")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("update_sample_average")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"Îµ-greedy-åŠ¨ä½œé€‰æ‹©"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#Îµ-greedy-åŠ¨ä½œé€‰æ‹©"}},[t._v("#")]),t._v(" Îµ-greedy åŠ¨ä½œé€‰æ‹©")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" numpy "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" np\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("epsilon_greedy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" epsilon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rand"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" epsilon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¢ç´¢")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argmax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# åˆ©ç”¨")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ“Š-ç»˜å›¾ä»£ç -å¤ç°å›¾-2-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Š-ç»˜å›¾ä»£ç -å¤ç°å›¾-2-1"}},[t._v("#")]),t._v(" ğŸ“Š ç»˜å›¾ä»£ç ï¼šå¤ç°å›¾ 2.1")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" numpy "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" np\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" matplotlib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pyplot "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" plt\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run_bandit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("epsilon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" runs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" k"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    rewards "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zeros"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("runs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" steps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    optimal_action_counts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zeros"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("runs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" steps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("runs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        q_true "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        optimal_action "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argmax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("q_true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        Q "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zeros"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        N "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zeros"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" t "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("steps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            action "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" epsilon_greedy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" epsilon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("normal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("q_true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n            Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" update_sample_average"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n            rewards"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" reward\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" action "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" optimal_action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                optimal_action_counts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" rewards"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("axis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" optimal_action_counts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("axis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nepsilons "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ncolors "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'green'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'red'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'black'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("figure"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("figsize"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" eps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("zip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("epsilons"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" colors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    avg_reward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" run_bandit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("avg_reward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" label"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'Îµ = ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("eps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" color"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Average Reward"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xlabel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ylabel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Average reward"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("legend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" eps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("zip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("epsilons"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" colors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    _"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" optimal_action "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" run_bandit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    plt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("optimal_action "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" label"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'Îµ = ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("eps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" color"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"% Optimal Action"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xlabel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ylabel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Optimal Action (%)"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("legend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tight_layout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nplt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("show"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br")])]),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ§ª-leetcode-é£æ ¼ç»ƒä¹ é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-leetcode-é£æ ¼ç»ƒä¹ é¢˜"}},[t._v("#")]),t._v(" ğŸ§ª LeetCode é£æ ¼ç»ƒä¹ é¢˜")]),t._v(" "),s("h3",{attrs:{id:"ğŸ“Œ-èƒŒæ™¯è¯´æ˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Œ-èƒŒæ™¯è¯´æ˜"}},[t._v("#")]),t._v(" ğŸ“Œ èƒŒæ™¯è¯´æ˜")]),t._v(" "),s("p",[t._v("ä½ æ­£åœ¨æ¨¡æ‹Ÿä¸€ä¸ªå¤šè‡‚è€è™æœºé—®é¢˜ï¼Œæœ‰ k ä¸ªåŠ¨ä½œã€‚ä½ æ¯æ¬¡é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œè·å¾—ä¸€ä¸ªå¥–åŠ±ã€‚è¯·å®ç°ä¸€ä¸ª Q å€¼ä¼°è®¡å™¨ï¼Œä½¿ç”¨ Îµ-greedy ç­–ç•¥é€‰æ‹©åŠ¨ä½œï¼Œå¹¶æ ¹æ®è¿”å›çš„å¥–åŠ±æ›´æ–° Q å€¼ï¼ˆä½¿ç”¨ sample averageï¼‰ã€‚")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"example-input-output"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-input-output"}},[t._v("#")]),t._v(" Example Input / Output")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("è¾“å…¥"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nåŠ¨ä½œé€‰æ‹©åºåˆ— "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nå¥–åŠ±åºåˆ— "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nÎµ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v("\nseed "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\nè¾“å‡º"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nQ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"å‡½æ•°å®šä¹‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‡½æ•°å®šä¹‰"}},[t._v("#")]),t._v(" å‡½æ•°å®šä¹‰")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("simulate_bandit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" actions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rewards"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" epsilon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" seed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"æµ‹è¯•ç”¨ä¾‹æ–­è¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•ç”¨ä¾‹æ–­è¨€"}},[t._v("#")]),t._v(" æµ‹è¯•ç”¨ä¾‹æ–­è¨€")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("allclose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("simulate_bandit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" seed"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("allclose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("simulate_bandit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" seed"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"âœ…-å®ç°å‚è€ƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-å®ç°å‚è€ƒ"}},[t._v("#")]),t._v(" âœ… å®ç°å‚è€ƒ")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("simulate_bandit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" actions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rewards"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" epsilon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" seed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    np"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Q "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" k\n    N "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" k\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("zip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("actions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rewards"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Q\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("hr"),t._v(" "),s("h2",{attrs:{id:"âœ…-å°ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-å°ç»“"}},[t._v("#")]),t._v(" âœ… å°ç»“")]),t._v(" "),s("ul",[s("li",[t._v("æœ¬èŠ‚ä»‹ç»å¦‚ä½•é€šè¿‡ sample-average æ–¹æ³•ä¼°è®¡åŠ¨ä½œä»·å€¼ï¼›")]),t._v(" "),s("li",[t._v("Îµ-greedy ç­–ç•¥åœ¨æ¢ç´¢ä¸åˆ©ç”¨ä¹‹é—´è¾¾åˆ°è‰¯å¥½å¹³è¡¡ï¼›")]),t._v(" "),s("li",[t._v("Îµ è¶Šå°ï¼Œè¶Šè¶‹è¿‘äºè´ªå©ªï¼ŒÎµ è¶Šå¤§æ¢ç´¢è¶Šå……åˆ†ï¼›")]),t._v(" "),s("li",[t._v("å®éªŒç»“æœè¡¨æ˜ï¼ŒÎµ=0.1 çš„ç­–ç•¥é€šå¸¸åœ¨åˆæœŸå’Œé•¿æœŸéƒ½è¡¨ç°æ›´å¥½ï¼›")]),t._v(" "),s("li",[t._v("ä½ å¯ä»¥é€šè¿‡ LeetCode é£æ ¼é—®é¢˜å·©å›ºç†è§£å¹¶å®ç°ä½ è‡ªå·±çš„ç‰ˆæœ¬ã€‚")])]),t._v(" "),s("h1",{attrs:{id:"çŠ¶æ€ä»·å€¼å‡½æ•°-v-s-ä¸-åŠ¨ä½œä»·å€¼å‡½æ•°-q-s-a-çš„åŒºåˆ«ä¸-td-æ›´æ–°å¯¹æ¯”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€ä»·å€¼å‡½æ•°-v-s-ä¸-åŠ¨ä½œä»·å€¼å‡½æ•°-q-s-a-çš„åŒºåˆ«ä¸-td-æ›´æ–°å¯¹æ¯”"}},[t._v("#")]),t._v(" çŠ¶æ€ä»·å€¼å‡½æ•° V(s) ä¸ åŠ¨ä½œä»·å€¼å‡½æ•° Q(s, a) çš„åŒºåˆ«ä¸ TD æ›´æ–°å¯¹æ¯”")]),t._v(" "),s("h2",{attrs:{id:"ğŸ§ -v-å’Œ-q-çš„æ ¹æœ¬åŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -v-å’Œ-q-çš„æ ¹æœ¬åŒºåˆ«"}},[t._v("#")]),t._v(" ğŸ§  V å’Œ Q çš„æ ¹æœ¬åŒºåˆ«")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æ¦‚å¿µ")]),t._v(" "),s("th",[t._v("çŠ¶æ€ä»·å€¼å‡½æ•° V(s)")]),t._v(" "),s("th",[t._v("åŠ¨ä½œä»·å€¼å‡½æ•° Q(s, a)")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("è¡¨ç¤º")]),t._v(" "),s("td",[t._v("åœ¨çŠ¶æ€ s ä¸‹çš„æœŸæœ›å›æŠ¥")]),t._v(" "),s("td",[t._v("åœ¨çŠ¶æ€ s ä¸‹æ‰§è¡ŒåŠ¨ä½œ a åçš„æœŸæœ›å›æŠ¥")])]),t._v(" "),s("tr",[s("td",[t._v("ä½¿ç”¨åœºæ™¯")]),t._v(" "),s("td",[t._v("ç­–ç•¥è¯„ä¼°ï¼ˆå¦‚ TD, Monte Carloï¼‰")]),t._v(" "),s("td",[t._v("ç­–ç•¥æ”¹è¿›ã€æ§åˆ¶ï¼ˆå¦‚ Q-learning, SARSAï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("ä¾èµ–")]),t._v(" "),s("td",[t._v("ä»…çŠ¶æ€ s")]),t._v(" "),s("td",[t._v("çŠ¶æ€ s å’ŒåŠ¨ä½œ a")])]),t._v(" "),s("tr",[s("td",[t._v("ä»£è¡¨çš„æ˜¯è°çš„æœŸæœ›")]),t._v(" "),s("td",[t._v("å½“å‰ç­–ç•¥ Ï€ åœ¨çŠ¶æ€ s ä¸‹çš„è¡¨ç°")]),t._v(" "),s("td",[t._v("å½“å‰ç­–ç•¥ Ï€ åœ¨çŠ¶æ€ s åšå‡º a çš„è¡¨ç°")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ”-td-æ›´æ–°-vå€¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-td-æ›´æ–°-vå€¼"}},[t._v("#")]),t._v(" ğŸ” TD æ›´æ–°ï¼ˆVå€¼ï¼‰")]),t._v(" "),s("p",[t._v("æ—¶åºå·®åˆ†æ³•ï¼ˆTemporal-Difference, TDï¼‰ç”¨äºå­¦ä¹ çŠ¶æ€ä»·å€¼å‡½æ•° V(s)ï¼š")]),t._v(" "),s("p",[t._v("$$\nV(s_t) \\leftarrow V(s_t) + \\alpha \\left[ r_{t+1} + \\gamma V(s_{t+1}) - V(s_t) \\right]\n$$")]),t._v(" "),s("ul",[s("li",[t._v("å­¦çš„æ˜¯ï¼šå½“å‰ç­–ç•¥ä¸‹ï¼ŒçŠ¶æ€ "),s("code",[t._v("s_t")]),t._v(" çš„é•¿æœŸæœŸæœ›å›æŠ¥ã€‚")]),t._v(" "),s("li",[t._v("TD æ˜¯ on-policy ç­–ç•¥è¯„ä¼°æ–¹æ³•ã€‚")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ†š-q-learning-æ›´æ–°-qå€¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ†š-q-learning-æ›´æ–°-qå€¼"}},[t._v("#")]),t._v(" ğŸ†š Q-learning æ›´æ–°ï¼ˆQå€¼ï¼‰")]),t._v(" "),s("p",[t._v("Q-learning å­¦çš„æ˜¯æœ€ä¼˜åŠ¨ä½œä»·å€¼å‡½æ•°ï¼š")]),t._v(" "),s("p",[t._v("$$\nQ(s_t, a_t) \\leftarrow Q(s_t, a_t) + \\alpha \\left[ r_{t+1} + \\gamma \\max_{a'} Q(s_{t+1}, a') - Q(s_t, a_t) \\right]\n$$")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("max_a'")]),t._v(" è¡¨ç¤ºä»ä¸‹ä¸€ä¸ªçŠ¶æ€ä¸­é€‰æ‹©æœ€ä¼˜åŠ¨ä½œï¼›")]),t._v(" "),s("li",[t._v("è¿™æ˜¯ç”¨äºç­–ç•¥ä¼˜åŒ–çš„ off-policy æ§åˆ¶æ–¹æ³•ï¼›")]),t._v(" "),s("li",[t._v("ç”¨äºåŠ¨ä½œé€‰æ‹©ï¼Œå¦‚ Îµ-greedy ç­–ç•¥ã€‚")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ”-ç±»æ¯”ç†è§£"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-ç±»æ¯”ç†è§£"}},[t._v("#")]),t._v(" ğŸ” ç±»æ¯”ç†è§£")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("åœºæ™¯")]),t._v(" "),s("th",[t._v("V(s)")]),t._v(" "),s("th",[t._v("Q(s, a)")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ä½ åœ¨æŸä¸ªåŸå¸‚")]),t._v(" "),s("td",[s("code",[t._v("V(s)")]),t._v(" å‘Šè¯‰ä½ è¿™ä¸ªåŸå¸‚çš„â€œå¹¸ç¦æŒ‡æ•°â€")]),t._v(" "),s("td",[s("code",[t._v("Q(s, a)")]),t._v(" å‘Šè¯‰ä½ åœ¨è¿™ä¸ªåŸå¸‚â€œé€‰æ‹©æŸç§æ´»åŠ¨â€åæœªæ¥å‡ å¤©å¯èƒ½æœ‰å¤šå¼€å¿ƒ")])]),t._v(" "),s("tr",[s("td",[t._v("æŠ•èµ„å†³ç­–")]),t._v(" "),s("td",[s("code",[t._v("V(s)")]),t._v(" æ˜¯å½“å‰å¸‚åœºçŠ¶æ€çš„æ”¶ç›ŠæœŸæœ›")]),t._v(" "),s("td",[s("code",[t._v("Q(s, a)")]),t._v(" æ˜¯åœ¨å½“å‰å¸‚åœºçŠ¶æ€é€‰æ‹©æŸç§æŠ•èµ„æ–¹æ¡ˆçš„æœŸæœ›æ”¶ç›Š")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"âœ…-æ€»ç»“å¯¹æ¯”è¡¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-æ€»ç»“å¯¹æ¯”è¡¨"}},[t._v("#")]),t._v(" âœ… æ€»ç»“å¯¹æ¯”è¡¨")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("ç»´åº¦")]),t._v(" "),s("th",[t._v("V(s)ï¼ˆTDå­¦ä¹ ï¼‰")]),t._v(" "),s("th",[t._v("Q(s, a)ï¼ˆQ-learning / Îµ-greedyï¼‰")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("è¾“å…¥")]),t._v(" "),s("td",[t._v("çŠ¶æ€ s")]),t._v(" "),s("td",[t._v("çŠ¶æ€ s ä¸åŠ¨ä½œ a")])]),t._v(" "),s("tr",[s("td",[t._v("è¾“å‡º")]),t._v(" "),s("td",[t._v("s çš„ä»·å€¼ä¼°è®¡")]),t._v(" "),s("td",[t._v("s, a å¯¹çš„ä»·å€¼ä¼°è®¡")])]),t._v(" "),s("tr",[s("td",[t._v("ç”¨é€”")]),t._v(" "),s("td",[t._v("è¯„ä¼°ç­–ç•¥")]),t._v(" "),s("td",[t._v("æ§åˆ¶ç­–ç•¥ï¼ˆé€‰æ‹©åŠ¨ä½œï¼‰")])]),t._v(" "),s("tr",[s("td",[t._v("TD æ›´æ–°")]),t._v(" "),s("td",[t._v("åŸºäº V(s')")]),t._v(" "),s("td",[t._v("åŸºäº max Q(s', a') æˆ– Q(s', a')")])]),t._v(" "),s("tr",[s("td",[t._v("ç®—æ³•ä¾‹å­")]),t._v(" "),s("td",[t._v("TD(0), TD(Î»), Monte Carlo")]),t._v(" "),s("td",[t._v("SARSA, Q-learning, DQN")])])])]),t._v(" "),s("hr"),t._v(" "),s("h1",{attrs:{id:"v-s-ä¸-q-s-a-æ˜¯å¦èƒ½è§£å†³ç›¸åŒé—®é¢˜-å…¨é¢è§£æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#v-s-ä¸-q-s-a-æ˜¯å¦èƒ½è§£å†³ç›¸åŒé—®é¢˜-å…¨é¢è§£æ"}},[t._v("#")]),t._v(" V(s) ä¸ Q(s, a) æ˜¯å¦èƒ½è§£å†³ç›¸åŒé—®é¢˜ï¼Ÿâ€”â€”å…¨é¢è§£æ")]),t._v(" "),s("h2",{attrs:{id:"âœ…-ç»“è®º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-ç»“è®º"}},[t._v("#")]),t._v(" âœ… ç»“è®º")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("V(s) å’Œ Q(s, a) éƒ½å¯ä»¥ç”¨æ¥è§£å†³ç›¸åŒçš„é—®é¢˜â€”â€”ä¹Ÿå°±æ˜¯æ‰¾åˆ°æœ€ä¼˜ç­–ç•¥ï¼ˆoptimal policyï¼‰ï¼Œä½†å®ƒä»¬çš„æ–¹å¼ä¸åŒï¼Œé€‚ç”¨çš„ç®—æ³•ä¹Ÿä¸åŒã€‚")])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ¯-ç›¸åŒç›®æ ‡-æ‰¾åˆ°æœ€ä¼˜ç­–ç•¥-Ï€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ç›¸åŒç›®æ ‡-æ‰¾åˆ°æœ€ä¼˜ç­–ç•¥-Ï€"}},[t._v("#")]),t._v(" ğŸ¯ ç›¸åŒç›®æ ‡ï¼šæ‰¾åˆ°æœ€ä¼˜ç­–ç•¥ Ï€*")]),t._v(" "),s("p",[t._v("æ— è®ºä½¿ç”¨ V è¿˜æ˜¯ Qï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡éƒ½æ˜¯ï¼š")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("æ‰¾åˆ°ä¸€ä¸ªç­–ç•¥ Ï€ï¼Œä½¿å¾—åœ¨æ¯ä¸ªçŠ¶æ€ä¸‹éƒ½èƒ½è·å¾—æœ€å¤§çš„é•¿æœŸç´¯è®¡å›æŠ¥ã€‚")])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ”-æ ¸å¿ƒåŒºåˆ«-ç­–ç•¥è¡¨ç¤ºä¸å­¦ä¹ æ–¹å¼ä¸åŒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-æ ¸å¿ƒåŒºåˆ«-ç­–ç•¥è¡¨ç¤ºä¸å­¦ä¹ æ–¹å¼ä¸åŒ"}},[t._v("#")]),t._v(" ğŸ” æ ¸å¿ƒåŒºåˆ«ï¼šç­–ç•¥è¡¨ç¤ºä¸å­¦ä¹ æ–¹å¼ä¸åŒ")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("é¡¹ç›®")]),t._v(" "),s("th",[t._v("åŸºäº V(s) çš„æ–¹æ³•")]),t._v(" "),s("th",[t._v("åŸºäº Q(s, a) çš„æ–¹æ³•")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ç­–ç•¥è·å–æ–¹å¼")]),t._v(" "),s("td",[t._v("Ï€(s) éœ€é€šè¿‡é¢å¤–æœç´¢ï¼ˆå¦‚ç­–ç•¥è¿­ä»£ï¼‰")]),t._v(" "),s("td",[t._v("Ï€(s) = argmaxâ‚ Q(s, a) å¯ç›´æ¥å†³ç­–")])]),t._v(" "),s("tr",[s("td",[t._v("å­¦çš„æ˜¯")]),t._v(" "),s("td",[t._v("çŠ¶æ€çš„ä»·å€¼")]),t._v(" "),s("td",[t._v("çŠ¶æ€+åŠ¨ä½œçš„ç»„åˆä»·å€¼")])]),t._v(" "),s("tr",[s("td",[t._v("ç­–ç•¥å­¦ä¹ ")]),t._v(" "),s("td",[t._v("éœ€é…åˆç­–ç•¥è¯„ä¼°ä¸æ”¹è¿›")]),t._v(" "),s("td",[t._v("Q å€¼æœ¬èº«å³ä¸ºæ§åˆ¶ç­–ç•¥ä¾æ®")])]),t._v(" "),s("tr",[s("td",[t._v("å…¸å‹ç®—æ³•")]),t._v(" "),s("td",[t._v("TD(0), TD(Î»), Policy Iteration")]),t._v(" "),s("td",[t._v("Q-learning, SARSA, DQN")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ§ -å®ä¾‹å¯¹æ¯”-è¿·å®«å¯¼èˆª"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -å®ä¾‹å¯¹æ¯”-è¿·å®«å¯¼èˆª"}},[t._v("#")]),t._v(" ğŸ§  å®ä¾‹å¯¹æ¯”ï¼šè¿·å®«å¯¼èˆª")]),t._v(" "),s("h3",{attrs:{id:"çŠ¶æ€-s-ä½ å½“å‰çš„ä½ç½®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€-s-ä½ å½“å‰çš„ä½ç½®"}},[t._v("#")]),t._v(" çŠ¶æ€ sï¼šä½ å½“å‰çš„ä½ç½®")]),t._v(" "),s("h3",{attrs:{id:"åŠ¨ä½œ-a-ä¸Šä¸‹å·¦å³ç§»åŠ¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŠ¨ä½œ-a-ä¸Šä¸‹å·¦å³ç§»åŠ¨"}},[t._v("#")]),t._v(" åŠ¨ä½œ aï¼šä¸Šä¸‹å·¦å³ç§»åŠ¨")]),t._v(" "),s("h3",{attrs:{id:"âœ…-åŸºäº-v-s"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-åŸºäº-v-s"}},[t._v("#")]),t._v(" âœ… åŸºäº V(s)")]),t._v(" "),s("ol",[s("li",[t._v("ç”¨ TD(0) æˆ–ç­–ç•¥è¿­ä»£ä¼°è®¡ V(s)ï¼›")]),t._v(" "),s("li",[t._v("æ¯ä¸€æ­¥ç”¨ one-step lookahead æœç´¢ï¼š\n$$\na^* = \\arg\\max_a \\left[ r + \\gamma V(s') \\right]\n$$")]),t._v(" "),s("li",[t._v("ä¾èµ–ç¯å¢ƒæ¨¡å‹ï¼ˆç¯å¢ƒè½¬ç§»æ¦‚ç‡ï¼‰æˆ–æ¨¡æ‹Ÿå™¨ã€‚")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"âœ…-åŸºäº-q-s-a"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-åŸºäº-q-s-a"}},[t._v("#")]),t._v(" âœ… åŸºäº Q(s, a)")]),t._v(" "),s("ol",[s("li",[t._v("ç›´æ¥ä¼°è®¡æ¯ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹çš„ä»·å€¼ï¼›")]),t._v(" "),s("li",[t._v("ç­–ç•¥å°±æ˜¯ï¼š\n$$\n\\pi(s) = \\arg\\max_a Q(s, a)\n$$")]),t._v(" "),s("li",[t._v("å®Œå…¨ model-freeï¼Œå¯ç”¨äºå®é™…æ¸¸æˆã€æ§åˆ¶ã€‚")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"âœ…-æ€»ç»“å¯¹æ¯”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-æ€»ç»“å¯¹æ¯”"}},[t._v("#")]),t._v(" âœ… æ€»ç»“å¯¹æ¯”")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æ¯”è¾ƒç‚¹")]),t._v(" "),s("th",[t._v("V(s) æ–¹æ³•")]),t._v(" "),s("th",[t._v("Q(s, a) æ–¹æ³•")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("æ˜¯å¦èƒ½è§£å†³ç›¸åŒé—®é¢˜")]),t._v(" "),s("td",[t._v("âœ… æ˜¯")]),t._v(" "),s("td",[t._v("âœ… æ˜¯")])]),t._v(" "),s("tr",[s("td",[t._v("æ–¹æ³•æ˜¯å¦ç›¸åŒ")]),t._v(" "),s("td",[t._v("âŒ å¦")]),t._v(" "),s("td",[t._v("âŒ å¦")])]),t._v(" "),s("tr",[s("td",[t._v("æ˜¯å¦é€‚åˆç­–ç•¥è¯„ä¼°")]),t._v(" "),s("td",[t._v("âœ… æ˜¯")]),t._v(" "),s("td",[t._v("âŒ é€šå¸¸ç”¨äºæ§åˆ¶")])]),t._v(" "),s("tr",[s("td",[t._v("æ˜¯å¦é€‚åˆæ§åˆ¶")]),t._v(" "),s("td",[t._v("âš ï¸ ä¸ç›´æ¥é€‚åˆ")]),t._v(" "),s("td",[t._v("âœ… æ˜¯")])]),t._v(" "),s("tr",[s("td",[t._v("æ˜¯å¦éœ€è¦ç¯å¢ƒæ¨¡å‹")]),t._v(" "),s("td",[t._v("âš ï¸ é€šå¸¸éœ€è¦")]),t._v(" "),s("td",[t._v("âœ… ä¸éœ€è¦ï¼ˆmodel-freeï¼‰")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ğŸ“Œ-å»ºè®®ä½¿ç”¨æ—¶æœº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Œ-å»ºè®®ä½¿ç”¨æ—¶æœº"}},[t._v("#")]),t._v(" ğŸ“Œ å»ºè®®ä½¿ç”¨æ—¶æœº")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("åº”ç”¨åœºæ™¯")]),t._v(" "),s("th",[t._v("æ¨èæ–¹æ³•")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("æ¸¸æˆæ§åˆ¶ï¼ˆAtariï¼‰")]),t._v(" "),s("td",[t._v("Q-learning / DQN")])]),t._v(" "),s("tr",[s("td",[t._v("ç­–ç•¥è¯„ä¼°")]),t._v(" "),s("td",[t._v("TD / V(s)")])]),t._v(" "),s("tr",[s("td",[t._v("Actor-Critic æ¨¡å‹")]),t._v(" "),s("td",[t._v("Critic ç”¨ V(s)ï¼ŒActor ç”¨ç­–ç•¥ç½‘ç»œ")])]),t._v(" "),s("tr",[s("td",[t._v("æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ ")]),t._v(" "),s("td",[t._v("Q-learning æ›´å¸¸ç”¨")])])])]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("å¦‚éœ€è¿›ä¸€æ­¥æ¯”è¾ƒ V å’Œ Q åœ¨ä»£ç å®ç°ä¸Šçš„å·®å¼‚ï¼Œæˆ– PyTorch å®ç° Q-learning vs TD æ–¹æ³•ï¼Œæˆ‘å¯ä»¥ç»§ç»­ä¸ºä½ æä¾›æ•™å­¦ç‰ˆæœ¬ã€‚")]),t._v(" "),s("h2",{attrs:{id:"_2-3-å¢é‡å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-å¢é‡å®ç°"}},[t._v("#")]),t._v(" 2.3 å¢é‡å®ç°")]),t._v(" "),s("p",[t._v("å¢é‡å¹³å‡æ›´æ–°ï¼š\n$Q_{k+1} = Q_k + \\frac{1}{k}(R_k - Q_k)$")]),t._v(" "),s("p",[t._v("é€šç”¨å½¢å¼ï¼š\n$\\text{NewEstimate} \\leftarrow \\text{OldEstimate} + \\alpha (\\text{Target} - \\text{OldEstimate})$")]),t._v(" "),s("h2",{attrs:{id:"_2-4-éå¹³ç¨³é—®é¢˜è¿½è¸ª-tracking-a-nonstationary-problem"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-éå¹³ç¨³é—®é¢˜è¿½è¸ª-tracking-a-nonstationary-problem"}},[t._v("#")]),t._v(" 2.4 éå¹³ç¨³é—®é¢˜è¿½è¸ª Tracking a Nonstationary Problem")]),t._v(" "),s("p",[t._v("æŒ‡æ•°è¡°å‡å¹³å‡ï¼ˆconstant step-sizeï¼‰ï¼š\n$Q_{k+1} = Q_k + \\alpha (R_k - Q_k)$")]),t._v(" "),s("p",[t._v("å±•å¼€åå½¢å¼ï¼š\n$Q_{k+1} = \\alpha R_k + (1-\\alpha)\\alpha R_{k-1} + \\cdots + (1-\\alpha)^k Q_1$")]),t._v(" "),s("h2",{attrs:{id:"_2-5-ä¹è§‚åˆå€¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-ä¹è§‚åˆå€¼"}},[t._v("#")]),t._v(" 2.5 ä¹è§‚åˆå€¼")]),t._v(" "),s("ul",[s("li",[t._v("è®¾ç½®åˆå€¼ä¸ºè¾ƒå¤§æ•°ï¼ˆå¦‚ $Q_1(a) = 5$ï¼‰")]),t._v(" "),s("li",[t._v("åˆå§‹é˜¶æ®µé¼“åŠ±å°è¯•æ‰€æœ‰åŠ¨ä½œ")])]),t._v(" "),s("h2",{attrs:{id:"_2-6-ä¸Šç½®ä¿¡ç•Œ-ucb-æ–¹æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-ä¸Šç½®ä¿¡ç•Œ-ucb-æ–¹æ³•"}},[t._v("#")]),t._v(" 2.6 ä¸Šç½®ä¿¡ç•Œï¼ˆUCBï¼‰æ–¹æ³•")]),t._v(" "),s("p",[t._v("é€‰æ‹©è§„åˆ™ï¼š\n$A_t = \\arg\\max_a \\left( Q_t(a) + c \\sqrt{\\frac{\\ln t}{N_t(a)}} \\right)$")]),t._v(" "),s("h2",{attrs:{id:"_2-7-æ¢¯åº¦ç­–ç•¥-gradient-bandits"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-æ¢¯åº¦ç­–ç•¥-gradient-bandits"}},[t._v("#")]),t._v(" 2.7 æ¢¯åº¦ç­–ç•¥ï¼ˆGradient Banditsï¼‰")]),t._v(" "),s("p",[t._v("ç­–ç•¥æ¦‚ç‡ï¼ˆsoftmaxï¼‰ï¼š\n$\\pi_t(a) = \\frac{e^{H_t(a)}}{\\sum_b e^{H_t(b)}}$")]),t._v(" "),s("p",[t._v("åå¥½æ›´æ–°è§„åˆ™ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¯¹é€‰æ‹©åŠ¨ä½œï¼š\n$H_{t+1}(A_t) = H_t(A_t) + \\alpha (R_t - \\bar{R_t})(1 - \\pi_t(A_t))$")]),t._v(" "),s("li",[t._v("å¯¹æœªé€‰æ‹©åŠ¨ä½œï¼š\n$H_{t+1}(a) = H_t(a) - \\alpha (R_t - \\bar{R_t})\\pi_t(a)$")])]),t._v(" "),s("h2",{attrs:{id:"_2-8-ä¸Šä¸‹æ–‡æ··æ··æœºé—®é¢˜-contextual-bandits"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-ä¸Šä¸‹æ–‡æ··æ··æœºé—®é¢˜-contextual-bandits"}},[t._v("#")]),t._v(" 2.8 ä¸Šä¸‹æ–‡æ··æ··æœºé—®é¢˜ï¼ˆContextual Banditsï¼‰")]),t._v(" "),s("ul",[s("li",[t._v("æ¯ä¸ªè½®æ¬¡ç»™å‡ºæç¤ºï¼Œä¾‹å¦‚ä¸åŒé¢œè‰²ï¼Œè¡¨ç¤ºä¸åŒçš„ task")]),t._v(" "),s("li",[t._v("å¯å­¦ä¹ ä»â€œæƒ…æ™¯â€åˆ°â€œåŠ¨ä½œâ€çš„ç­–ç•¥ï¼šå³å­¦ä¹  policy")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"_2-9-æ€»ç»“-summary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-æ€»ç»“-summary"}},[t._v("#")]),t._v(" 2.9 æ€»ç»“ï¼ˆSummaryï¼‰")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Îµ-greedy")]),t._v("ï¼šç®€å•ã€æœ‰æ•ˆï¼Œæ¯ä¸ªåŠ¨ä½œæœ€ç»ˆéƒ½ä¼šè¢«å°è¯•æ— ç©·æ¬¡")]),t._v(" "),s("li",[s("strong",[t._v("UCB")]),t._v("ï¼šç¡®å®šæ€§åœ°é€‰æ‹©æœ€ä¸ç¡®å®šçš„åŠ¨ä½œï¼Œé¿å…æ— æ•ˆæ¢ç´¢")]),t._v(" "),s("li",[s("strong",[t._v("æ¢¯åº¦ Bandit")]),t._v("ï¼šä¸ä¼°è®¡å€¼ï¼Œè€Œä¼°è®¡åå¥½ï¼Œç”¨ softmax æ¦‚ç‡å†³ç­–")]),t._v(" "),s("li",[s("strong",[t._v("ä¹è§‚åˆå§‹åŒ–")]),t._v("ï¼šå³ä½¿ greedy æ–¹æ³•ä¹Ÿèƒ½é€šè¿‡åˆå§‹åŒ–å€¼å¼ºè¿«æ¢ç´¢")])]),t._v(" "),s("p",[t._v("å›¾2.5 å±•ç¤ºäº†å„ç§ç®—æ³•åœ¨ä¸åŒå‚æ•°è®¾ç½®ä¸‹çš„å¹³å‡å¥–åŠ±è¡¨ç°ã€‚")]),t._v(" "),s("h3",{attrs:{id:"ç»“è®º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è®º"}},[t._v("#")]),t._v(" ç»“è®ºï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ‰€æœ‰æ–¹æ³•åœ¨é€‚ä¸­å‚æ•°å€¼ä¸‹æ•ˆæœæœ€ä½³")]),t._v(" "),s("li",[t._v("åœ¨ 10-armed testbed ä¸Šï¼ŒUCB æ•´ä½“è¡¨ç°æœ€ä¼˜")])]),t._v(" "),s("p",[t._v("å°½ç®¡è¿™äº›æ–¹æ³•ç®€å•ï¼Œä½†å®ƒä»¬æ„æˆäº†ç°ä»£å¼ºåŒ–å­¦ä¹ ä¸­æ¢ç´¢-åˆ©ç”¨å¹³è¡¡çš„æ ¸å¿ƒæŠ€æœ¯ã€‚")]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"leetcode-é£æ ¼ç»ƒä¹ é¢˜-ä¸­è‹±åŒè¯­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#leetcode-é£æ ¼ç»ƒä¹ é¢˜-ä¸­è‹±åŒè¯­"}},[t._v("#")]),t._v(" LeetCode é£æ ¼ç»ƒä¹ é¢˜ï¼ˆä¸­è‹±åŒè¯­ï¼‰")]),t._v(" "),s("h3",{attrs:{id:"ğŸ§ª-ç»ƒä¹ -2-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-ç»ƒä¹ -2-1"}},[t._v("#")]),t._v(" ğŸ§ª ç»ƒä¹  2.1")]),t._v(" "),s("p",[s("strong",[t._v("é¢˜ç›®ï¼ˆä¸­æ–‡ï¼‰")]),t._v("ï¼šå¦‚å›¾2.1æ‰€ç¤ºï¼Œå“ªç§æ–¹æ³•åœ¨é•¿æœŸç´¯è®¡å¥–åŠ±ä¸Šè¡¨ç°æœ€å¥½ï¼Ÿå®šé‡è¡¨è¾¾å…¶ä¼˜åŠ¿ã€‚\n"),s("strong",[t._v("Question (EN)")]),t._v(": According to Figure 2.1, which method performs best in long-run cumulative reward and optimal action selection? Quantify the advantage.")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" best_method "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"epsilon_greedy_0.01"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("abs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("best_reward "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.55")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.05")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ§ª-ç»ƒä¹ -2-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-ç»ƒä¹ -2-2"}},[t._v("#")]),t._v(" ğŸ§ª ç»ƒä¹  2.2")]),t._v(" "),s("p",[s("strong",[t._v("é¢˜ç›®ï¼ˆä¸­æ–‡ï¼‰")]),t._v("ï¼šå†™å‡ºä¸€ä¸ªå®Œæ•´çš„ Îµ=0 çš„è´ªå©ª n-armed bandit ç®—æ³•ä¼ªä»£ç ï¼Œä½¿ç”¨å¢é‡å¹³å‡ä¼°è®¡ã€‚\n"),s("strong",[t._v("Question (EN)")]),t._v(": Write pseudocode for greedy n-armed bandit with incremental average estimate.")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("greedy_bandit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bandit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    Q "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" n\n    N "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" argmax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bandit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Q\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ§ª-ç»ƒä¹ -2-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-ç»ƒä¹ -2-3"}},[t._v("#")]),t._v(" ğŸ§ª ç»ƒä¹  2.3")]),t._v(" "),s("p",[s("strong",[t._v("é¢˜ç›®ï¼ˆä¸­æ–‡ï¼‰")]),t._v("ï¼šå¯¹äºä¸€èˆ¬ä¸æ’å®šçš„æ­¥é•¿ Î±_kï¼Œè¯·å†™å‡ºå‰å¥–åŠ±æƒé‡çš„ä¸€èˆ¬å…¬å¼ã€‚\n"),s("strong",[t._v("Question (EN)")]),t._v(": For general non-constant Î±_k, what are the weights on prior rewards?")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("weighted_average")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rewards"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" alphas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    total "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    weight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" alpha "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("zip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("reversed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rewards"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("reversed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("alphas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        weight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" alpha"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        total "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" weight "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" r\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" total\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ§ª-ç»ƒä¹ -2-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-ç»ƒä¹ -2-4"}},[t._v("#")]),t._v(" ğŸ§ª ç»ƒä¹  2.4")]),t._v(" "),s("p",[s("strong",[t._v("é¢˜ç›®ï¼ˆä¸­æ–‡ï¼‰")]),t._v("ï¼šè®¾è®¡å®éªŒï¼Œå±•ç¤ºæ ·æœ¬å¹³å‡æ–¹æ³•åœ¨éå¹³ç¨³ä»»åŠ¡ä¸­çš„é—®é¢˜ã€‚\n"),s("strong",[t._v("Question (EN)")]),t._v(": Design an experiment showing sample-average issues in nonstationary bandits.")]),t._v(" "),s("p",[t._v("æ–­è¨€æ ·æœ¬å¹³å‡æ–¹æ³•åœ¨åæœŸè¡¨ç°å·®äºå›ºå®šæ­¥é•¿æ–¹æ³•ï¼š")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" avg_reward_sample "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" avg_reward_constant\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ§ª-ç»ƒä¹ -2-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-ç»ƒä¹ -2-5"}},[t._v("#")]),t._v(" ğŸ§ª ç»ƒä¹  2.5")]),t._v(" "),s("p",[s("strong",[t._v("é¢˜ç›®ï¼ˆä¸­æ–‡ï¼‰")]),t._v("ï¼šä¸ºä»€ä¹ˆå›¾2.2ä¸­ optimistic æ–¹æ³•å‰æœŸæ³¢åŠ¨å¤§ï¼Ÿ\n"),s("strong",[t._v("Question (EN)")]),t._v(": Why are there early spikes in Figure 2.2 for the optimistic method?")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" early_fluctuations_reason "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"disappointment-induced switching"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ§ª-ç»ƒä¹ -2-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ª-ç»ƒä¹ -2-6"}},[t._v("#")]),t._v(" ğŸ§ª ç»ƒä¹  2.6")]),t._v(" "),s("p",[s("strong",[t._v("é¢˜ç›®ï¼ˆä¸­æ–‡ï¼‰")]),t._v("ï¼šåœ¨ä½ æ— æ³•åŒºåˆ† Case A / B æ—¶ï¼Œè¯¥å¦‚ä½•æœ€å¤§åŒ–æœŸæœ›å¥–åŠ±ï¼Ÿ\n"),s("strong",[t._v("Question (EN)")]),t._v(": When you can't tell A/B bandit task apart, how do you act optimally?")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("expected_reward")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# = 0.55 + 0.45 = 1.0")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("abs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("expected_reward"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-6")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);